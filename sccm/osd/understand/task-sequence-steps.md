---
title: "工作順序步驟 | Configuration Manager"
description: "了解您可新增至 Configuration Manager 工作順序的工作順序步驟。"
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology:
- configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 7c888a6f-8e37-4be5-8edb-832b218f266d
caps.latest.revision: 26
caps.handback.revision: 0
author: Dougeby
ms.author: dougeby
manager: angrobe
translationtype: Human Translation
ms.sourcegitcommit: 2a45cfb3e00d8078fbf45bdc8a2668b7dd0a62c6
ms.openlocfilehash: 538cb9795586115ad8b52b44fb82b50a0abdbaa2


---
# <a name="task-sequence-steps-in-system-center-configuration-manager"></a>System Center Configuration Manager 中的工作順序步驟

*適用於：System Center Configuration Manager (最新分支)*

下列工作順序步驟可以新增至 Configuration Manager 工作順序。 如需編輯工作順序的相關資訊，請參閱 [Edit a task sequence](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_ModifyTaskSequence)。  


##  <a name="a-namebkmkapplydataimagea-apply-data-image-task-sequence-step"></a><a name="BKMK_ApplyDataImage"></a> 套用資料映像工作順序步驟  
 使用 [套用資料映像]  工作順序步驟，以將資料映像複製到指定的目的地磁碟分割。  

 此步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱[工作順序動作變數](task-sequence-action-variables.md)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **映像套件**  
 指定按一下 [瀏覽]  時，此工作順序步驟將會使用的 [映像套件] 。 在 [選取套件]  對話方塊中，選取您想要安裝的套件。 [選取套件]  對話方塊底部會顯示每個現有映像套件的關聯內容資訊。 從所選取的 [映像套件]  ，使用下拉式清單來選取您想要安裝的 [映像] 。  

> [!NOTE]  
>  此工作順序動作會將映像視為資料檔案，並不會執行將映像當作作業系統來啟動所需的任何設定。  

 **目的地**  
 指定現有的格式化磁碟分割和硬碟、特定的邏輯磁碟機代號，或是包含邏輯磁碟機代號之工作順序變數的名稱。  

-   **下一個可用的磁碟分割** - 使用先前尚未被這個工作順序中的 [套用作業系統] 或 [套用資料映像] 動作設為目標的下一個循序磁碟分割。  

-   **特定磁碟和磁碟分割** - 選取 [磁碟] 編號 (從 0 開始) 和 [磁碟分割] 編號 (從 1 開始)。  

-   **特定邏輯磁碟機代號** - 指定 Windows PE 指派給磁碟分割的 [磁碟機代號]。 請注意，這個磁碟機代號可以不同於新部署之作業系統將會指派的磁碟機代號。  

-   **儲存在變數中的邏輯磁碟機代號** - 指定工作順序變數，其中包含 Windows PE 指派給磁碟分割的磁碟機代號。 這個變數通常會設定在 [格式化與分割磁碟]  工作順序動作的 [磁碟分割內容]  對話方塊的 [進階] 區段中。  

 **套用映像之前，先刪除磁碟分割上的所有內容**  
 指定在安裝映像之前，會先刪除目標磁碟分割上的所有檔案。 若不刪除磁碟分割的內容，這個步驟可用來將其他內容套用至先前設為目標的磁碟分割。  

##  <a name="a-namebkmkapplydriverpackagea-apply-driver-package"></a><a name="BKMK_ApplyDriverPackage"></a> 套用驅動程式套件  
 使用 [套用驅動程式套件]  工作順序步驟，下載驅動程式套件中的所有驅動程式，並將其安裝在 Windows 作業系統上。

 [套用驅動程式套件]  工作順序步驟讓驅動程式套件中的所有裝置驅動程式皆可供 Windows 使用。 這個步驟可以新增至 [套用作業系統]   與 [設定 Windows 和 ConfigMgr]  步驟之間的工作順序中，讓驅動程式封裝中的裝置驅動程式可以供 Windows 使用。 一般而言，[套用驅動程式套件]  步驟會放在 [自動套用驅動程式]  工作順序步驟之後。 [套用驅動程式套件]  工作順序步驟也適合用於獨立媒體部署案例。  

 請務必將相似的裝置驅動程式放在驅動程式套件中，然後將其散發至適當的發佈點。 將其散發之後，Configuration Manager 用戶端電腦即可加以安裝。 例如，您可以將某個製造商的所有裝置驅動程式放在一個驅動程式套件中，然後將該套件散發到關聯電腦可以存取的發佈點。

 這個步驟適用於獨立媒體以及想要安裝一組特定驅動程式 (包括不會在隨插即用掃描中偵測到之裝置的驅動程式，例如網路印表機) 的系統管理員。  

 此工作順序步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Apply Driver Package Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyDriverPackage)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **驅動程式套件**  
 按一下 [瀏覽]  ，並啟動 [選取套件]  對話方塊，以指定包含所需裝置驅動程式的驅動程式套件。 指定要提供使用的現有套件。 相關聯的套件內容會顯示在對話方塊底部。  

 **選取在 Windows Vista 前版作業系統部署上設定之前，必須安裝之套件的大型存放驅動程式**  
 指定安裝 Windows Vista 前版作業系統所需的任何大型存放裝置驅動程式。  

 **驅動程式**  
 選取在 Windows Vista 前版作業系統部署上設定之前，所要安裝的大型存放裝置驅動程式檔案。 下拉式清單中會填入所指定的套件。  

 **型號**  
 指定 Windows Vista 前版作業系統部署所需的開機必備裝置。  

 **在允許的 Windows 版本上執行自動安裝未簽署的驅動程式**  
 選取此選項，可讓 Windows 在參照電腦上安裝未簽署的驅動程式。  

##  <a name="a-namebkmkapplynetworksettingsa-apply-network-settings-step"></a><a name="BKMK_ApplyNetworkSettings"></a> 套用網路設定步驟  
 使用 [套用網路設定]  工作順序步驟，指定目的地電腦的網路或工作群組組態資訊。 指定的值會以適當的回應檔案格式存放，以在執行 [設定 Windows 和 ConfigMgr]  工作順序步驟時，供 Windows 安裝程式使用。  

 此工作順序步驟可以在標準作業系統或 Windows PE 中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Apply Network Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyNetworkSettings)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **加入工作群組**  
 選取此選項可讓目的地電腦加入指定的工作群組。 在 [工作群組]  列上輸入工作群組的名稱。 [擷取網路設定]  工作順序步驟所擷取的值會覆寫此值。  

 **加入網域**  
 選取此選項可讓目的地電腦加入指定的網域。 指定或瀏覽至網域，例如 *fabricam.com*。 指定或瀏覽至組織單位的輕量型目錄存取通訊協定 (LDAP) 路徑 (亦即 LDAP//OU=電腦，DC=Fabricam.com，C=com)。  

 **帳戶**  
 按一下 [設定]  ，指定具有將電腦加入網域所需權限的帳戶。 在 [Windows 使用者帳戶]  對話方塊中，您可以使用下列格式輸入使用者名稱： **網域\使用者** 。  

 **介面卡設定**  
 為電腦中的每個網路介面卡指定網路組態。 按一下 [新增]  ，以開啟 [網路設定]  對話方塊，然後指定網路設定。 如果在先前的 [擷取網路設定]  工作順序步驟中已擷取網路設定，則會將先前的設定套用至網路介面卡，而不會套用在此步驟中指定的設定。 如果先前沒有擷取網路設定，則會依 Windows 裝置列舉順序，將 [套用網路設定]  步驟中指定的設定套用至網路介面卡。  

##  <a name="a-namebkmkapplyoperatingsystemimagea-apply-operating-system-image"></a><a name="BKMK_ApplyOperatingSystemImage"></a> 套用作業系統映像  
 使用 [套用作業系統映像]  工作順序步驟，將作業系統安裝在目的地電腦上。 此工作順序步驟會執行一組動作，取決於它是使用作業系統映像或作業系統安裝套件來安裝作業系統。  

 使用作業系統映像時，[套用作業系統映像]  步驟會執行下列動作。  

1.  刪除目標磁碟區上的所有內容，但 _SMSTSUserStatePath 工作順序變數所指定的資料夾下的那些檔案除外。  

2.  將指定 .wim 檔案的內容，擷取至指定的目的地磁碟分割。  

3.  準備回應檔案：  

    1.  針對所要部署的作業系統，建立新的預設 Windows 安裝程式回應檔案 (sysprep.inf 或 unattend.xml)。  

    2.  將使用者提供的回應檔案中的任何值合併。  

4.  將 Windows 開機載入器複製到作用中的磁碟分割。  

5.  設定 boot.ini 或開機組態資料庫 (BCD) 來參照新安裝的作業系統。  

 使用作業系統安裝套件時，[套用作業系統映像]  步驟會執行下列動作。  

1.  刪除目標磁碟區上的所有內容，但 _SMSTSUserStatePath 工作順序變數所指定的資料夾下的那些檔案除外。  

2.  準備回應檔案：  

    1.  使用 Configuration Manager 所建立的標準值，建立一個全新的回應檔案。  

    2.  將使用者提供的回應檔案中的任何值合併。  

> [!NOTE]  
>  實際的 Windows 安裝是由 [設定 Windows 和 ConfigMgr]  工作順序步驟所啟動。 [套用作業系統]  工作順序動作執行之後，OSDTargetSystemDrive 工作順序變數會設為包含作業系統檔案之磁碟分割的磁碟機代號。  

 此工作順序步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Apply Operating System Image Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyOperatingSystem)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   **直接從發佈點存取內容**：  

     使用此選項來指定是否要讓工作順序直接從發佈點存取作業系統映像。 例如，當您將作業系統部署到儲存容量有限的內嵌裝置時，就可以使用此選項。 選取此選項時，您也必須在套件內容的 [資料存取]  索引標籤上，設定套件共用設定。  

    > [!NOTE]  
    >  此設定會覆寫在 [部署軟體精靈]  的 [發佈點]  頁面上設定的部署選項 (僅針對此工作順序步驟中指定的作業系統映像，而不是整個工作順序的所有內容)。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **從擷取的映像套用作業系統**  
 安裝先前擷取的作業系統映像。 按一下 [瀏覽]  以開啟 [選取套件]  對話方塊，然後選取您要安裝的現有映像套件。 如果多個映像與指定的 [映像套件] 相關聯，請使用下拉式清單來指定將用於此部署的相關聯套件。 您可以按一下映像，以檢視每個現有映像的基本資訊。  

 **從原始安裝來源套用作業系統映像**  
 使用原始安裝來源安裝作業系統。 按一下 [瀏覽]  以開啟 [選取作業系統安裝套件]  對話方塊，然後選取您要使用的現有作業系統安裝套件。 您可以按一下映像來源，以檢視每個現有映像來源的基本資訊。 相關聯的映像來源內容會顯示在對話方塊底部的結果窗格中。 如果有多個版本與指定的套件相關聯，請使用下拉式清單來指定所使用的關聯 [版本]  。  

 **使用自動安裝或 sysprep 回應檔案進行自訂安裝**  
 根據作業系統版本和安裝方法，使用此選項來提供 Windows 安裝程式回應檔案 (**unattend.xml**、 **unattend.txt**或 **sysprep.inf**)。 您指定的檔案可以包含 Windows 回應檔案所支援的任何標準組態選項。 例如，您可以用它來指定預設 Internet Explorer 首頁。 您必須指定包含回應檔案的套件，以及該檔案在套件中的關聯路徑。  

> [!NOTE]  
>  您提供的 Windows 安裝程式回應檔案可以包含 %*varname*% 形式的內嵌工作順序變數，其中 varname 為變數的名稱。 在 [設定 Windows 和 ConfigMgr]工作順序動作中，% **varname** % 字串將會取代為實際的變數值。 不過，請注意，這類內嵌的工作順序變數不能用在 unattend.xml 回應檔案中的純數字欄位。  

 如果您未提供 Windows 安裝程式回應檔案，此工作順序動作將會自動產生回應檔案。  

 **目的地**  
 指定現有的格式化磁碟分割和硬碟、特定的邏輯磁碟機代號，或是包含邏輯磁碟機代號之工作順序變數的名稱。  

-   **下一個可用的磁碟分割** - 使用先前尚未被這個工作順序中的 [套用作業系統] 或 [套用資料映像] 動作設為目標的下一個循序磁碟分割。  

-   **特定磁碟和磁碟分割** - 選取 [磁碟] 編號 (從 0 開始) 和 [磁碟分割] 編號 (從 1 開始)。  

-   **特定邏輯磁碟機代號** - 指定 Windows PE 指派給磁碟分割的 [磁碟機代號]。 請注意，這個磁碟機代號可以不同於新部署之作業系統將會指派的磁碟機代號。  

-   **儲存在變數中的邏輯磁碟機代號** - 指定工作順序變數，其中包含 Windows PE 指派給磁碟分割的磁碟機代號。 這個變數通常會設定在 [格式化與分割磁碟]  工作順序動作的 [磁碟分割內容]  對話方塊的 [進階] 區段中。  

##  <a name="a-namebkmkapplywindowssettingsa-apply-windows-settings"></a><a name="BKMK_ApplyWindowsSettings"></a> 套用 Windows 設定  
 使用 [套用 Windows 設定]  工作順序步驟來設定目的地電腦的 Windows 設定。 指定的值會以適當的回應檔案格式存放，以在執行 [設定 Windows 和 ConfigMgr]  工作順序步驟時，供 Windows 安裝程式使用。  

 此工作順序步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Apply Windows Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyWindowsSettings)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **使用者名稱**  
 指定與目的地電腦相關聯的已註冊使用者名稱。 [擷取 Windows 設定]  工作順序動作所擷取的值會覆寫此值。  

 **組織名稱**  
 指定與目的地電腦相關聯的已註冊組織名稱。 [擷取 Windows 設定]  工作順序動作所擷取的值會覆寫此值。  

 **產品金鑰**  
 指定要在目的地電腦上進行 Windows 安裝所使用的產品金鑰。  

 **伺服器授權**  
 指定伺服器授權模式。 您可以選取 [每部伺服器]  或 [每位使用者]  做為授權模式。 如果您選取 [每部伺服器] 做為授權模式，也必須指定每個授權合約所允許的連線數目上限。 如果目的地電腦不是伺服器，或是您不想指定授權模式，則選取 [不指定]  。  

 **連線數目上限**  
 依據授權合約的陳述，指定可用於這部電腦的連線數目上限。  

 **隨機產生本機系統管理員密碼，並在所有支援的平台上停用帳戶 (建議)**  
 選取此選項，以隨機產生本機系統管理員密碼。 這會建立本機系統管理員密碼，並在所有支援的平台上停用帳戶。  

 **啟用帳戶並指定本機系統管理員密碼**  
 選取此選項可啟用本機系統管理員帳戶，並建立本機系統管理員密碼。 在 [密碼]  列上輸入密碼，並在 [確認密碼]  列上確認密碼。  

 **時區**  
 指定要在目的地電腦上設定的時區。 [擷取 Windows 設定]  工作順序步驟所擷取的值會覆寫此值。  

##  <a name="a-namebkmkautoapplydriversa-auto-apply-drivers"></a><a name="BKMK_AutoApplyDrivers"></a> 自動套用驅動程式  
 使用 [自動套用驅動程式]  工作順序步驟來比對及安裝驅動程式，以做為作業系統部署的一部分。  

 [自動套用驅動程式]  工作順序步驟會執行下列動作：  

1.  掃描硬體，並尋找存在於系統上之所有裝置的隨插即用識別碼。  

2.  將裝置及其隨插即用識別碼的清單傳送至管理點。 管理點會從每個裝置的驅動程式類別目錄傳回相容的驅動程式清單。 不論驅動程式是在什麼驅動程式封裝中，管理點都會將所有驅動程式納入考量， 但只會考量標示所指定驅動程式類別的驅動程式，以及未標示為停用的驅動程式。  

3.  針對每個裝置，用戶端都會挑選最適合其部署所在作業系統，且位於可存取之發佈點上的驅動程式。  

4.  所選取的驅動程式會從發佈點下載，並且在目標作業系統上執行。  

    1.  若是以映像為基礎的安裝，驅動程式會放在作業系統驅動程式存放區中。  

    2.  若是以安裝程式為基礎的安裝，Windows 安裝程式會設定要尋找驅動程式的位置。  

5.  當 [設定 Windows 和 ConfigMgr]  工作順序動作執行，而 Windows 初始開機時，會尋找此動作所執行的驅動程式。  

> [!IMPORTANT]
>  因為 Windows 安裝程式不會連線到 Configuration Manager 站台，所以 [自動套用驅動程式] 工作順序步驟無法用於獨立媒體。

此工作順序步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Auto Apply Drivers Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_AutoApplyDrivers)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **只安裝最符合的相容驅動程式**  
 指定工作順序步驟只針對所偵測到的每個硬體裝置，安裝最符合的驅動程式。  

 **安裝所有相容的驅動程式**  
 指定工作順序步驟針對所偵測到的每個硬體裝置，安裝所有相容的驅動程式，並允許 Windows 安裝程式選擇最佳的驅動程式。 這個選項需要較多的網路頻寬和磁碟空間，因為它會下載較多驅動程式，但是最後會選出較好的驅動程式。  

 **考量所有類別的驅動程式**  
 指定工作順序動作會在所有可用的驅動程式類別中搜尋適當的裝置驅動程式。  

 **將驅動程式比對僅限於考量所選類別中的驅動程式**  
 指定工作順序動作在適當裝置驅動程式的指定驅動程式類別中，搜尋裝置驅動程式。  

 **在允許的 Windows 版本上執行自動安裝未簽署的驅動程式**  
 允許這個工作順序動作安裝未簽署的 Windows 裝置驅動程式。  

> [!IMPORTANT]  
>  此選項不會套用至無法設定驅動程式簽署原則的作業系統。  

##  <a name="a-namebkmkcapturenetworksettingsa-capture-network-settings"></a><a name="BKMK_CaptureNetworkSettings"></a> 擷取網路設定  
 使用 [擷取網路設定]  工作順序步驟，以從執行工作順序的電腦擷取 Microsoft 網路設定。 這些設定會儲存在工作順序變數中，將會覆寫您在 [套用網路設定]  工作順序步驟中進行的預設設定。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Capture Network Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureNetworkSettings)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 提供進一步的詳細資訊，描述在此步驟中所採取的動作。  

 **移轉網域和工作群組成員資格**  
 擷取目的地電腦的網域和工作群組成員資格資訊。  

 **移轉網路介面卡組態**  
 擷取目的地電腦的網路介面卡組態。 擷取到的資訊包括全域網路設定、介面卡的數目，以及與每個介面卡相關聯的網路設定。 這些設定包括與 DNS、WINS、IP 和連接埠篩選相關聯的設定。  

##  <a name="a-namebkmkcaptureoperatingsystemimagea-capture-operating-system-image"></a><a name="BKMK_CaptureOperatingSystemImage"></a> 擷取作業系統映像  
 使用 [擷取作業系統映像]  工作順序步驟，從參照電腦擷取一或多個映像，並將其存放在指定網路共用上的 WIM 檔案中。 然後就可以使用 [新增作業系統映像套件精靈]，將這個 .WIM 檔案匯入 Configuration Manager 中，使其可以用於以映像為基礎的作業系統部署。  

 參照電腦上的每個磁碟區 (磁碟機) 都會被擷取成 .wim 檔案內的個別映像。 如果參照的電腦中有多個磁碟區，所產生的 WIM 檔案將會包含每個磁碟區的個別映像。 只會擷取格式化為 NTFS 或 FAT32 的磁碟區。 會略過其他格式的磁碟區和 USB 磁碟區。  

 參照電腦上所安裝的作業系統必須是 Configuration Manager 所支援的 Windows 版本，而且必須已使用 SysPrep 工具做好準備。 所安裝的作業系統磁碟區和開機磁碟區必須是相同的磁碟區。  

 您也必須輸入具有您選取之網路共用的寫入權限的 Windows 帳戶。  

 此工作順序步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Capture Operating System Image Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureOperatingSystemImage)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **Target**  
 Configuration Manager 在儲存所擷取的作業系統映像時使用之位置的檔案系統路徑名稱。  

 **說明**  
 選用的使用者定義的描述，說明儲存在 .WIM 檔案中，所擷取的作業系統映像。  

 **版本**  
 選用的使用者定義的版本號碼，可指派給所擷取的作業系統映像。 這個值可以是字母和數字的任何組合，並且儲存在 .WIM 檔案中。  

 **建立者**  
 建立作業系統映像之使用者的選用名稱，儲存在 WIM 檔案中。  

 **擷取作業系統映像帳戶**  
 您必須輸入具有您指定之網路共用權限的 Windows 帳戶。 按一下 [設定]  ，以指定該 Windows 帳戶的名稱。  

##  <a name="a-namebkmkcaptureuserstatea-capture-user-state"></a><a name="BKMK_CaptureUserState"></a> 擷取使用者狀態  
 使用 [擷取使用者狀態]  工作順序步驟，以利用使用者狀態移轉工具 (USMT)，從執行工作順序的電腦擷取使用者狀態和設定。 這個工作順序步驟會與 [還原使用者狀態]  工作順序步驟搭配使用。 若使用 USMT 3.0.1 和更新版本，此選項一律會使用由 Configuration Manager 產生和管理的加密金鑰來加密 USMT 狀態存放區。  

 如需在部署作業系統時管理使用者狀態的詳細資訊，請參閱[管理使用者狀態](../get-started/manage-user-state.md)。  

 如果您想要將狀態設定儲存至 Configuration Manager 站台中的狀態移轉點，或是從該點還原設定，您也可以搭配使用 [擷取使用者狀態] 工作順序步驟與 [要求狀態存放區] 和 [釋放狀態存放區] 工作順序步驟。  

 [擷取使用者狀態]  工作順序步驟可讓您控制最常用的 USMT 選項的有限子集。 您可以使用 OSDMigrateAdditionalCaptureOptions 工作順序變數來指定其他命令列選項。  

 此工作順序步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Capture User State Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureUserState)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **使用者狀態移轉工具套件**  
 輸入 Configuration Manager 套件，其中包含可讓此工作順序步驟在擷取使用者狀態和設定時使用的 USMT 版本。 此套件不需要程式。 執行工作順序步驟時，工作順序將會使用您指定之套件中的 USMT 版本。 依據您要從中擷取狀態之作業系統的架構，指定包含 32 位元或 x64 版 USMT 的套件。  

 **以標準選項擷取所有使用者設定檔**  
 選取此選項可移轉所有使用者設定檔資訊。 預設會選取這個選項。  

 如果您選取這個選項，但是未在 [還原使用者狀態] 工作順序步驟中選取 [還原本機使用者設定檔] 選項，工作順序將會失敗，因為在未指派密碼的情況下，Configuration Manager 無法移轉新帳戶。 此外，如果您使用 [新增工作順序精靈]  ，並建立工作順序來 [安裝現有的映像套件] ，所產生的工作順序預設為 [以標準選項擷取所有使用者設定檔]，但不會選取 [還原本機電腦使用者設定檔] (亦即非網域帳戶) 選項。  

 選取 [還原本機電腦使用者設定檔]  ，並提供要移轉之帳戶的密碼。 在手動建立的工作順序中，可以在 [還原使用者狀態] 步驟底下找到這項設定。 在由 [新增工作順序精靈]  建立的工作順序中，可以在 [還原使用者檔案和設定精靈]  步驟頁面底下找到這項設定。  

 如果您沒有本機使用者帳戶，這不適用此說明。  

 **自訂如何擷取使用者設定檔**  
 選取此選項來指定自訂設定檔的檔案移轉。 按一下 [檔案]  ，選取要用於此步驟的 USMT 組態檔。 您必須指定自訂的 .xml 檔案，其中包含定義所要移轉之使用者狀態檔案的規則。  

 **按一下這裡選取組態檔：**  
 選取這個選項，以選取您要在 USMT 套件中用來擷取使用者設定檔的組態檔。 按一下 [檔案]  按鈕，以啟動 [組態檔]  對話方塊。 若要指定組態檔，請在 [檔案名稱]  列上輸入檔案名稱，並按一下 [新增]  按鈕。  

 **啟用詳細資訊記錄**  
 啟用此選項可產生較詳細的記錄檔資訊。 擷取狀態時會產生 Scanstate.log 記錄檔，且根據預設會儲存在 \windows\system32\ccm\logs 資料夾的工作順序記錄檔資料夾中。  

 **略過使用加密檔案系統的檔案**  
 如果您想要略過使用加密檔案系統 (EFS) 來加密的檔案 (包括設定檔)，而不擷取，請啟用此選項。 根據作業系統和 USMT 版本，在還原之後，可能就無法讀取加密檔案。 如需詳細資訊，請參閱 USMT 說明文件。  

 **使用檔案系統存取進行複製**  
 啟用此選項可指定下列任何設定：  

-   **無法擷取部分檔案時仍繼續**：啟用這項設定，即使無法擷取某些檔案，還是會繼續移轉程序。 如果停用這個選項，當無法擷取某個檔案時，工作順序步驟就會失敗。 這個選項預設為啟用。  

-   **藉由使用連結而非複製檔案在本機擷取**：啟用這項設定，可使用 NTFS 永久連結來擷取檔案。  

     如需使用永久連結來移轉資料的詳細資訊，請參閱 [永久連結移轉存放區](http://go.microsoft.com/fwlink/p/?LinkId=240222)  

-   **以離線模式擷取 (僅限 Windows PE)**：啟用這項設定，可以在 Windows PE (而不是完整作業系統) 中時，擷取使用者狀態。  

 **使用磁碟區陰影複製服務 (VSS) 來擷取**  
 這項選項可讓您在檔案被鎖定，無法由其他應用程式進行編輯的情況下，仍可擷取檔案。  

##  <a name="a-namebkmkcapturewindowssettingsa-capture-windows-settings"></a><a name="BKMK_CaptureWindowsSettings"></a> 擷取 Windows 設定  
 使用 [擷取 Windows 設定]  工作順序步驟，以從執行工作順序的電腦擷取 Windows 設定。 這些設定會儲存在工作順序變數中，將會覆寫您在 [套用 Windows 設定]  工作順序步驟中進行的預設設定。  

 此工作順序步驟可以在 Windows PE 或標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Capture Windows Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureWindowsSettings)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **移轉電腦名稱**  
 選取此選項可擷取電腦的 NetBIOS 電腦名稱。  

 **移轉已註冊的使用者和組織名稱**  
 選取此選項，可從電腦擷取已註冊的使用者和組織名稱。  

 **移轉時區**  
 選取此選項可擷取電腦上的時區設定。  

##  <a name="a-namebkmkcheckreadinessa-check-readiness"></a><a name="BKMK_CheckReadiness"></a> 檢查整備程度  
 使用 [檢查整備]  工作順序步驟，確認目標電腦符合指定的部署必要條件。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。 針對此步驟，請勿選取這個設定，否則此步驟只會記錄整備檢查，而當檢查失敗時，並不會停止工作順序。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **確定最小記憶體 (MB)**  
 選取此設定，可確認安裝在目標電腦上的記憶體數量 (以 MB 為單位) 符合或超過所指定的數量。 預設會選取此設定。  

 **確定最小處理器速度 (MHz)**  
 選取此設定，可確認安裝在目標電腦上的處理器速度 (以 MHz 為單位) 符合或超過所指定的數量。 預設會選取此設定。  

 **確定最小可用磁碟空間 (MB)**  
 選取此設定，可確認目標電腦上的可用磁碟空間 (以 MB 為單位) 符合或超過所指定的數量。  

 **確定要重新整理的目前作業系統為**  
 選取此設定，可確認安裝在目標電腦上的作業系統符合您指定的需求。 根據預設，會以 [用戶端] 值來選取這個設定。  

##  <a name="a-namebkmkconnecttonetworkfoldera-connect-to-network-folder"></a><a name="BKMK_ConnectToNetworkFolder"></a> 連線到網路資料夾  
 使用 [連線到網路資料夾]  工作順序動作，以建立連接到共用網路資料夾的連線。  

 此工作順序步驟可以在標準作業系統或 Windows PE 中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Connect to Network Folder Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ConnecttoNetworkFolder)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

##  <a name="a-namebkmkconvertdisktodynamica-convert-disk-to-dynamic"></a><a name="BKMK_ConvertDisktoDynamic"></a> 將磁碟轉換成動態磁碟  
 使用 [將磁碟轉換為動態]  工作順序步驟，將實體磁碟從基本磁碟類型轉換成動態磁碟類型。  

 此步驟可以在標準作業系統或 Windows PE 中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Convert Disk to Dynamic Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ConvertDisk)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **磁碟編號**  
 將要轉換之磁碟的實體磁碟編號。  

##  <a name="a-namebkmkdisablebitlockera-disable-bitlocker"></a><a name="BKMK_DisableBitLocker"></a> 停用 BitLocker  
 使用 [停用 BitLocker]  工作順序步驟，以停用目前作業系統磁碟或特定磁碟上的 BitLocker 加密。 這個動作會讓金鑰保護裝置以純文字繼續顯示在硬碟上，但是不會將磁碟機的內容解密。 因此，這個動作幾乎是立即完成。  

> [!NOTE]  
>  BitLocker 磁碟機加密提供磁碟區內容的低階加密。  

 如果您有多個加密的磁碟機，必須先停用任何資料磁碟機上的 BitLocker，才能停用作業系統磁碟機上的 BitLocker。  

 這個步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 提供進一步的詳細資訊，描述在此步驟中所採取的動作。  

 **目前的作業系統磁碟機**  
 在目前的作業系統磁碟機上停用 BitLocker。  

 **特定磁碟機**  
 在特定磁碟機上停用 BitLocker。 使用下拉式清單來指定要停用 BitLocker 的磁碟機。  

##  <a name="a-namebkmkdownloadpackagecontenta-download-package-content"></a><a name="BKMK_DownloadPackageContent"></a> 下載封裝內容  
 使用 [下載封裝內容]  工作順序步驟，以下載下列任何封裝類型：  

-   作業系統映像  

-   作業系統升級套件  

-   驅動程式套件  

-   套件  

 這個步驟適用於在下列情況中升級作業系統的工作順序：  

-   若要使用可同時搭配 x86 和 x64 平台使用的單一升級工作順序。 若要這樣做，請在 [準備升級]  群組中加入兩個 [下載封裝內容]  步驟，這些步驟設有條件，可偵測用戶端架構，並僅下載適用的作業系統升級封裝。 將每個 **下載套件內容** 步驟設定為使用相同的變數，並使用該變數來代表 **升級作業系統** 步驟中的媒體路徑。  

-   若要動態下載適用的驅動程式套件，請使用兩個 **下載套件內容** 步驟，並設定條件來偵測每個驅動程式套件適用的硬體類型。 將每個 [下載封裝內容]  步驟設定成使用相同的變數，並使用這個變數來表示 [升級作業系統]  步驟之 [驅動程式] 區段中的 [分段內容]  值。  

 這個步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 提供進一步的詳細資訊，描述在此步驟中所採取的動作。  

 **選取封裝** 圖示  
 按一下圖示可選取要下載的封裝。 選取封裝之後，您可以再按一下圖示，以選擇另一個封裝。  

 **放入下列位置**  
 選擇此選項可將封裝儲存在下列其中一個位置：  

-   **工作順序工作目錄**  

-   **Configuration Manager 用戶端快取**：您可以使用這個選項將內容儲存在用戶端快取中。 這樣做可讓用戶端作為其他對等快取用戶端的對等快取來源。 如需詳細資訊，請參閱[準備 Windows PE 對等快取以減少 WAN 流量](../get-started/prepare-windows-pe-peer-cache-to-reduce-wan-traffic.md)。  

-   **自訂路徑**  

 **將路徑儲存為變數**  
 您可以將路徑儲存為可用於另一個工作順序步驟的變數。 有多個套件時，Configuration Manager 會在變數名稱後面加上數值尾碼。 例如，如果您指定 %*mycontent*% 變數作為自訂變數，這會是所有參照內容儲存位置的根目錄 (可以是多個封裝)。 當您在後續步驟 (例如 [升級作業系統]) 中參考此變數時，會使用加上數值尾碼的變數。 在這個範例中，%*mycontent01*% 或 %*mycontent02*% 中的數字會與封裝在這個步驟中列出的順序對應。  

 **如有封裝下載失敗，繼續下載清單中的其他封裝**  
 指定如有封裝下載失敗，則會移至清單中的下一個封裝並開始下載。  

##  <a name="a-namebkmkenablebitlockera-enable-bitlocker"></a><a name="BKMK_EnableBitLocker"></a> 啟用 BitLocker  
 使用 [啟用 BitLocker]  工作順序步驟，可以在硬碟機上的至少兩個磁碟分割中啟用 BitLocker 加密。 第一個作用中磁碟分割包含 Windows 開機程式碼。 另一個磁碟分割包含作業系統。 開機磁碟分割必須保持未加密狀態。  

 使用 [預先佈建 BitLocker]  工作順序步驟，以在 Windows PE 中時，在磁碟機上啟用 BitLocker。 如需詳細資訊，請參閱此主題中的＜ [預先佈建 BitLocker](#BKMK_PreProvisionBitLocker) ＞一節。  

> [!NOTE]  
>  BitLocker 磁碟機加密提供磁碟區內容的低階加密。  

 [啟用 BitLocker]  步驟只能在標準作業系統中執行。 它不會在 Windows PE 中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Enable BitLocker Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_EnableBitLocker)。  

 當您指定 [僅 TPM] 、[TPM 和 USB 上的啟動金鑰]  或 [TPM 和 PIN] 時，可信賴平台模組 (TPM) 必須處於下列狀態，才能執行 [啟用 BitLocker]  步驟：  

-   已啟用  

-   已啟動  

-   允許的擁有權  

 工作順序步驟可以完成任何剩餘的 TPM 初始化作業，因為其餘步驟不需要您親自執行或重新開機。 可以藉由 [啟用 BitLocker]  明確完成的其餘 TPM 初始化步驟 (如有必要) 包括：  

-   建立簽署金鑰組  

-   建立擁有者授權值和委付至 Active Directory，Active Directory 必須已擴充為支援此值  

-   取得擁有權  

-   建立儲存根金鑰，或者如果已經存在，但不相容，則重設  

 如果您想要讓 [啟用 BitLocker]  步驟等到磁碟機加密程序完成之後，再繼續進行工作順序中的下一個步驟，請選取 [等候]  核取方塊。 如果您未選取 [等候]  核取方塊，將會在背景中執行磁碟機加密程序，而工作順序執行作業會立即繼續進行下一個步驟。  

 BitLocker 可以用來將電腦系統上的多個磁碟機加密 (包括作業系統和資料磁碟機)。 若要將資料磁碟機加密，作業系統必須已經加密，而且加密程序必須完成，因為資料磁碟機的金鑰保護裝置會存放在作業系統磁碟機上。 如此一來，如果您在相同的程序中將作業系統磁碟機和資料磁碟機加密，則必須針對為作業系統磁碟機啟用 BitLocker 的步驟選取 [等候] 選項。  

 如果硬碟機已加密，但停用 BitLocker，[啟用 BitLocker] 會重新啟用金鑰保護裝置，而且是幾乎立即完成。 在此情況下，並不需要重新加密硬碟機。  

 如需這項動作之工作順序變數的詳細資訊，請參閱 [Enable BitLocker Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_EnableBitLocker)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 為這個工作順序步驟指定描述性名稱。  

 **說明**  
 可讓您選擇性地輸入這個工作順序步驟的描述。  

 **選擇要加密的磁碟機**  
 指定要加密的磁碟機。 若要將目前的作業系統磁碟機加密，請選取 [目前的作業系統磁碟機]  ，然後設定下列其中一個選項來進行金鑰管理：  

-   **僅 TPM**：選取這個選項只會使用可信賴平台模組 (TPM)。  

-   **僅 USB 上的啟動金鑰**：選取這個選項可使用存放在 USB 快閃磁碟機上的啟動金鑰。 當您選取此選項時，BitLocker 會鎖定一般開機程序，直到有包含 BitLocker 啟動金鑰的 USB 裝置連接到電腦為止。  

-   **TPM 和 USB 上的啟動金鑰**：選取這個選項可使用 TPM 和存放在 USB 快閃磁碟機上的啟動金鑰。 當您選取此選項時，BitLocker 會鎖定一般開機程序，直到有包含 BitLocker 啟動金鑰的 USB 裝置連接到電腦為止。  

-   **TPM 和 PIN**：選取這個選項可使用 TPM 和個人識別碼 (PIN)。 當您選取此選項時，BitLocker 會鎖定一般開機程序，直到使用者提供 PIN。  

 若要將特定的非作業系統資料磁碟機加密，請選取 [特定磁碟機] ，然後從清單中選取磁碟機。  

 **選擇要建立修復金鑰的位置**  
 若要指定建立修復密碼的位置，請選取 [在 Active Directory 中]  ，以在 Active Directory 中委任密碼。 如果您選取此選項，就必須為網站擴充 Active Directory，以便儲存相關聯的 BitLocker 修復資訊。 如果您決定根本不要建立密碼，可以選取 [不要建立修復金鑰] 。 不過，最好是建立密碼。  

 **等候 BitLocker 在所有磁碟機上完成磁碟機加密程序，再繼續執行工作順序**  
 選取此選項可讓 BitLocker 磁碟機加密先完成後，再執行工作順序中的下一個步驟。 如果選取此選項，就會先將整個磁碟區加密，使用者才能登入電腦。  

 在加密型硬碟機時，加密程序可能需要數小時才能完成。 若未選取此選項，則會讓工作順序立即繼續進行。  

##  <a name="a-namebkmkformatandpartitiondiska-format-and-partition-disk"></a><a name="BKMK_FormatandPartitionDisk"></a> 格式化和分割磁碟  
 使用 [格式化和分割磁碟]  工作順序步驟，可將目的地電腦上的指定磁碟格式化和分割。  

> [!IMPORTANT]  
>  您為此工作順序步驟指定的每項設定，都會套用至單一指定磁碟。 如果您想要將目的地電腦上的另一個磁碟格式化和分割，您必須將另一個 [格式化和分割磁碟]  工作順序步驟加入工作順序。  

 此工作順序步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需這項動作之工作順序變數的詳細資訊，請參閱 [Format and Partition Disk Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_FormatPartitionDisk)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **磁碟編號**  
 將要格式化之磁碟的實體磁碟編號。 該編號取決於 Windows 磁碟列舉排序。  

 **磁碟類型**  
 所要格式化的磁碟類型。 下拉式清單中有兩個選項可供選取：  

-   標準 (MBR) - 主開機記錄。  

-   GPT - GUID 磁碟分割表格  

> [!NOTE]  
>  如果您將磁碟類型從 [標準 (MBR)]  變更為 [GPT] ，而且磁碟分割配置包含延伸磁碟分割，則會從配置中移除所有延伸及邏輯磁碟分割。 在變更磁碟類型之前，會提示您確認此動作。  

 **磁碟區**  
 所要建立之磁碟分割或磁碟區的特定相關資訊，包括下列項目：  

-   Name  

-   剩餘的磁碟空間  

 若要建立新的磁碟分割，請按一下 [新增]  ，以啟動 [磁碟分割內容]  對話方塊。 您可以指定磁碟分割類型和大小，以及指定這是否要做為開機磁碟分割。 若要修改現有的磁碟分割，請按一下要修改的磁碟分割，然後按一下 [內容] 按鈕。 如需如何設定硬碟分割的詳細資訊，請參閱下列其中一項：  

-   [如何設定以 UEFI/GPT 為基礎的硬碟分割](http://go.microsoft.com/fwlink/?LinkID=272104)  

-   [如何設定以 BIOS/MBR 為基礎的硬碟分割](http://go.microsoft.com/fwlink/?LinkId=272105)  

 若要刪除磁碟分割，請選取所要刪除的磁碟分割，然後按一下 [刪除] 。  

##  <a name="a-namebkmkinstallapplicationa-install-application"></a><a name="BKMK_InstallApplication"></a> 安裝應用程式  
 使用 [安裝應用程式]  工作順序步驟，以在工作順序中安裝應用程式。 這個步驟可以安裝工作順序步驟所指定的一組應用程式，或是工作順序變數動態清單所指定的一組應用程式。 執行這個步驟時，應用程式安裝會立即開始，而不會等待原則輪詢間隔。  

 所安裝的應用程式必須符合下列準則：  

-   應用程式的部署類型必須是 Windows Installer 或指令碼安裝程式。 不支援 Windows 應用程式套件 (.appx 檔案) 部署類型。  

-   必須以本機系統帳戶而不是使用者帳戶來執行。  

-   它不能與桌面互動。 必須以無訊息模式或自動模式來執行程式。  

-   絕不能自行初始化重新啟動。 應用程式必須使用標準重新啟動代碼 (3010 結束代碼) 來要求重新啟動。 這樣可以確保工作順序步驟會正確處理重新啟動。 如果應用程式確實傳回 3010 結束代碼，基礎工作順序引擎就會執行重新啟動。 重新啟動之後，工作順序會自動繼續進行。  

 當執行 [安裝應用程式]  步驟時，應用程式會針對應用程式的部署類型，檢查需求規則和偵測方法的適用性。 根據這項檢查的結果，應用程式會安裝適用的部署類型。 如果部署類型包含相依性，則會在安裝應用程式步驟中，評估並安裝相依的部署類型。 針對獨立媒體，不支援應用程式相依性。  

> [!NOTE]  
>  如果所要安裝的應用程式，會取代另一個應用程式，被取代之應用程式的內容檔案必須可供使用，否則工作順序步驟將會失敗。 例如，Microsoft Visio 2010 已安裝在用戶端或擷取的映像中。 執行 [安裝應用程式] 工作順序步驟來安裝 Microsoft Visio 2013 時，發佈點上必須要有 Microsoft Visio 2010 (被取代的應用程式) 的內容檔案上，否則工作順序將會失敗。 如果用戶端或擷取的映像未安裝 Microsoft Visio，則會完成 Microsoft Visio 2013 安裝，而不會檢查 Microsoft Visio 2010 內容檔案。  

> [!NOTE]
> 您可以使用 SMSTSMPListRequestTimeoutEnabled 和 SMSTSMPListRequestTimeout 內建變數，以啟用和指定工作順序從位置服務擷取管理點清單失敗後，到重新嘗試安裝應用程式或軟體更新之前等待的毫秒數。 如需詳細資訊，請參閱[工作順序內建變數](task-sequence-built-in-variables.md)。

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在電腦意外重新啟動時，重試這個步驟。 您也可以指定重新啟動之後要重試的次數。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **安裝下列應用程式**  
 此設定會指定要依指定順序安裝的應用程式。  

 Configuration Manager 將會篩選掉任何停用的應用程式，或是具有下列設定的任何應用程式。 這些應用程式不會出現在 [選取要安裝的應用程式]  對話方塊中。  

-   只有在使用者登入時  

-   以使用者權限執行  

 **根據動態變數清單安裝應用程式**  
 這個設定會針對為集合或電腦定義的一組工作順序變數，指定基底名稱。 這些變數會指定要為該集合或電腦安裝的應用程式。 每個變數名稱都是由其一般基底名稱加上從 01 開始的數字尾碼所組成。 每個變數的值都必須只包含應用程式的名稱。  

 針對要使用動態變數清單來安裝的應用程式，必須在應用程式 [內容] 對話方塊的 [一般] 索引標籤上啟用下列設定：[Allow this application to be installed from the Install Application task sequence action instead of deploying manually] (允許在不手動部署此應用程式的情況下，從安裝應用程式工作順序動作安裝該應用程式)  

> [!NOTE]  
>  針對獨立媒體部署，無法使用動態變數清單來安裝應用程式。  

 例如，若要使用名為 AA01 的工作順序變數來安裝單一應用程式，您要指定下列變數：  

|變數名稱|變數值|  
|-------------------|--------------------|  
|AA01|Microsoft Office|  

 若要安裝兩個應用程式，您要指定下列變數：  

|變數名稱|變數值|  
|-------------------|--------------------|  
|AA01|Microsoft Lync|  
|AA02|Microsoft Office|  

 下列條件將會影響安裝的內容：  

-   如果變數的值包含應用程式名稱以外的任何資訊， 則不會安裝該應用程式，而工作順序會繼續進行。  

-   如果找不到任何變數具有所指定的基底名稱和 "01" 後置詞，則不會安裝任何應用程式。 如果您在工作順序步驟的 [選項] 索引標籤上選取 [發生錯誤時仍繼續]，當應用程式安裝失敗時，工作順序會繼續進行。 如果未選取此設定，工作順序就會失敗，而且不會安裝其餘的應用程式。  

 **如果某個應用程式失敗，繼續安裝清單中的其他應用程式**  
 此設定指定如果個別應用程式安裝失敗，步驟將繼續進行。 如果指定此設定，無論傳回任何安裝錯誤，工作順序都會繼續進行。 如果未指定此設定，當安裝失敗時，工作順序步驟會立即結束。  

##  <a name="a-namebkmkinstalldeploymenttoolsa-install-deployment-tools"></a><a name="BKMK_InstallDeploymentTools"></a> 安裝部署工具  
 使用 [安裝部署工具] 工作順序步驟，安裝包含 Sysprep 部署工具的 Configuration Manager 套件。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **Sysprep 套件**  
 此設定會針對下列作業系統，指定包含 Sysprep 部署工具的 Configuration Manager 套件：  

-   Windows XP SP3  

-   Windows XP X64 SP2  

-   Windows Server 2003 SP2  

##  <a name="a-namebkmkinstallpackagea-install-package"></a><a name="BKMK_InstallPackage"></a> 安裝套件

 使用 [安裝套件]  工作順序步驟，以在工作順序中安裝軟體。 執行這個步驟時，安裝會立即開始，而不會等待原則輪詢間隔  

 所安裝的軟體必須符合下列準則：  

-   必須以本機系統帳戶而不是使用者帳戶來執行。  

-   它不應與桌面互動。 必須以無訊息模式或自動模式來執行程式。  

-   絕不能自行初始化重新啟動。 軟體必須使用標準重新啟動代碼 (3010 結束代碼) 來要求重新啟動。 這樣可以確保工作順序步驟會正確處理重新啟動。 如果軟體確實傳回 3010 結束代碼，基礎工作順序引擎將會執行重新啟動。 重新啟動之後，工作順序會自動繼續進行。  

 在部署作業系統時，不支援使用 [先執行另一個程式]  選項來安裝相依程式的程式。 如果為軟體啟用 [先執行另一個程式]  ，並且已經在目的地電腦上執行相依程式，則將會執行相依程式，且工作順序將會繼續進行。 不過，如果尚未在目的地電腦上執行相依程式，工作順序步驟將會失敗。  

> [!NOTE]  
>  管理中心網站並未包含執行工作順序期間啟用軟體發佈代理程式所需的所有用戶端設定原則。 若在管理中心網站建立工作順序的獨立媒體，且該工作順序包含 [安裝套件]  步驟，CreateTsMedia.log 檔案中可能會出現下列錯誤：  
>   
>  `"WMI method SMS_TaskSequencePackage.GetClientConfigPolicies failed (0x80041001)"`  
>   
>  若獨立媒體包含 [安裝套件] 步驟，您必須在啟用軟體發佈代理程式的主要網站建立獨立媒體，或是在 [設定 Windows 和 ConfigMgr]  步驟之後以及第一個 [安裝套件]  步驟之前新增 [執行命令列]  步驟。 [執行命令列]  步驟會執行 WMIC 命令，在第一個安裝套件步驟執行之前啟用軟體發佈代理程式。 您可以在 [執行命令列]  工作順序中使用下列內容：  
>   
>  **命令列**：**WMIC /命名空間:\\\root\ccm\policy\machine\requestedconfig path ccm_SoftwareDistributionClientConfig CREATE ComponentName="Enable SWDist", Enabled="true", LockSettings="TRUE", PolicySource="local", PolicyVersion="1.0", SiteSettingsKey="1" /NOINTERACTIVE**  
>   
>  如需建立獨立媒體的詳細資訊，請參閱[建立獨立媒體](../deploy-use/create-stand-alone-media.md)。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **安裝單一軟體套件**  
 此設定會指定 Configuration Manager 軟體套件。 此步驟會等待安裝完成。  

 **根據動態變數清單安裝軟體套件**  
 這個設定會針對為集合或電腦定義的一組工作順序變數，指定基底名稱。 這些變數會指定要為該集合或電腦安裝的套件。 每個變數名稱都是由其一般基底名稱加上從 001 開始的數字尾碼所組成。 每個變數的值都必須包含封裝識別碼和軟體名稱，並以分號分隔。  

 針對要使用動態變數清單來安裝的軟體，必須在套件 [內容] 對話方塊的 [進階] 索引標籤上啟用下列設定：[允許在不部署此程式的情況下，從安裝套件工作順序安裝該程式]。  

> [!NOTE]  
>  針對獨立媒體部署，無法使用動態變數清單來安裝軟體套件。  

 例如，若要使用名為 AA001 的工作順序變數來安裝單一軟體套件，您要指定下列變數：  

|變數名稱|變數值|  
|-------------------|--------------------|  
|AA001|CEN00054:Install|  

 若要安裝三個軟體套件，您要指定下列變數：  

|變數名稱|變數值|  
|-------------------|--------------------|  
|AA001|CEN00054:Install|  
|AA002|CEN00107:Install Silent|  
|AA003|CEN00031:Install|  

 下列條件將會影響安裝的內容：  

-   如果變數的值不是以正確格式來建立，或是未指定有效的應用程式識別碼和名稱，該軟體將會安裝失敗。  

-   如果套件識別碼包含小寫字元，該軟體將會安裝失敗。  

-   如果找不到任何變數具有所指定的基底名稱和 "001" 後置詞，則不會安裝任何套件，而工作順序會繼續進行。  

 **如果某個軟體套件安裝失敗，繼續安裝清單中其他套件**  
 此設定指定如果個別軟體套件安裝失敗，步驟將繼續進行。 如果指定此設定，無論傳回任何安裝錯誤，工作順序都會繼續進行。 如果未指定此設定，當安裝失敗時，工作順序步驟會立即結束。  

##  <a name="a-namebkmkinstallsoftwareupdatesa-install-software-updates"></a><a name="BKMK_InstallSoftwareUpdates"></a> 安裝軟體更新  
 使用 [安裝軟體更新]  工作順序步驟，在目的地電腦上安裝軟體更新。 在執行此工作順序步驟之前，不會評估目的地電腦適用的軟體更新。 執行之後，才會評估目的地電腦適用的軟體更新，就像任何其他 Configuration Manager 管理的用戶端一樣。 特別是，這個步驟只會安裝以電腦目前所屬集合為目標的軟體更新。  
>  [!IMPORTANT]
>強烈建議您在使用「安裝軟體更新」工作順序步驟時，安裝最新版本的 Windows 更新代理程式以獲得較佳的效能。
>* 若是 Windows 7，請參閱 [知識庫文章 3161647](https://support.microsoft.com/kb/3161647)。
>* 若是 Windows 8，請參閱 [知識庫文章 3163023](https://support.microsoft.com/kb/3163023)。

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的相關資訊，請參閱 [Install Software Updates Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_InstallSoftwareUpdates)。

 > [!NOTE]
 > 您可以使用 SMSTSMPListRequestTimeoutEnabled 和 SMSTSMPListRequestTimeout 內建變數，以啟用和指定工作順序從位置服務擷取管理點清單失敗後，到重新嘗試安裝應用程式或軟體更新之前等待的毫秒數。 如需詳細資訊，請參閱[工作順序內建變數](task-sequence-built-in-variables.md)。

> [!NOTE]
>您可以在 [選項] 索引標籤上，設定在電腦意外重新啟動時重試這個工作順序。 例如，在安裝軟體更新時會自動重新啟動電腦的情況下。 從 Configuration Manager 1602 開始，您可以設定 SMSTSWaitForSecondReboot 變數來指定在安裝軟體更新並重新啟動電腦之後，工作順序應該暫停多久 (以秒為單位)。 如需詳細資訊，請參閱[工作順序內建變數](task-sequence-built-in-variables.md)。

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在電腦意外重新啟動時，重試這個步驟。 您也可以指定重新啟動之後要重試的次數。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **安裝必備 - 僅限強制軟體更新**  
 選取此選項，可以為接收工作順序的目的地電腦，安裝 Configuration Manager 中標示為必要的所有軟體更新。 必要的軟體更新具有系統管理員定義的安裝截止日期。  

 **可供安裝 - 所有軟體更新**  
 選取此選項，可針對將要接收工作順序的 Configuration Manager 集合，安裝所有可用的軟體更新。 所有可用的軟體更新都會安裝在目的地電腦上。  

 **從快取掃描結果評估軟體更新**  
從 Configuration Manager 版本 1606 開始，您可以執行軟體更新的完整掃描，而不是使用快取的掃描結果。 工作順序預設會使用快取的結果。 您可以清除核取方塊，讓用戶端連線至軟體更新點，以處理並下載最新的軟體更新類別目錄。 若涉及大量軟體更新且當中有許多相依性 (例如需要先安裝 X，Y 才會顯示為適用) 的情況下，您可在使用工作順序以[擷取並建立作業系統映像](../deploy-use/create-a-task-sequence-to-capture-an-operating-system.md)時，選擇此選項。 當您清除此設定，並將工作順序部署到大量的用戶端時，所有用戶端都會同時連線至軟體更新點。 這可能會導致處理和下載類別目錄期間的效能問題。 在大部分情況下，我們建議您使用預設設定。

Configuration Manager 版本 1606 已引進 SMSTSSoftwareUpdateScanTimeout 新工作順序變數，可讓您在「安裝軟體更新」工作順序步驟期間，控制軟體更新掃描的逾時。 預設值為 30 分鐘。 如需詳細資訊，請參閱[工作順序內建變數](task-sequence-built-in-variables.md)。


##  <a name="a-namebkmkjoindomainorworkgroupa-join-domain-or-workgroup"></a><a name="BKMK_JoinDomainorWorkgroup"></a> 加入網域或工作群組  
 使用 [加入網域或工作群組]  工作順序步驟，將目的地電腦新增至工作群組或網域。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的相關資訊，請參閱 [Join Domain or Workgroup Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_JoinDomainWorkgroup)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **加入工作群組**  
 選取此選項可讓目的地電腦加入指定的工作群組。 如果電腦目前是網域的成員，選取此選項將會導致電腦重新啟動。  

 **加入網域**  
 選取此選項可讓目的地電腦加入指定的網域。  

 您可以選擇輸入或瀏覽指定網域中的組織單位 (OU)，以讓電腦加入。 如果電腦目前是某個其他網域或工作群組的成員，這將會導致電腦重新啟動。 如果電腦已經是某個其他 OU 的成員，Active Directory 網域服務會不允許您變更 OU，這項設定會被忽略。  

 **輸入有權加入網域的帳戶**  
 按一下 [設定]  ，輸入有權加入網域的帳戶和密碼。 必須以下列格式輸入帳戶：  

 *網域\帳戶*  

##  <a name="a-namebkmkprepareconfigmgrclientforcapturea-prepare-configmgr-client-for-capture"></a><a name="BKMK_PrepareConfigMgrClientforCapture"></a> 準備 ConfigMgr 用戶端以進行擷取  
 使用 [準備 ConfigMgr 用戶端以進行擷取] 步驟，以採用參照電腦上的 Configuration Manager 用戶端，並執行下列工作，將該用戶端準備好，以便在執行映像建立程序時進行擷取：  

-   從 Windows 目錄中的 smscfg.ini 檔案中，移除用戶端組態內容區段。 這些內容包含用戶端特定的資訊，包括 Configuration Manager GUID 和其他用戶端識別項。  

-   刪除所有 SMS 或 Configuration Manager 電腦憑證。  

-   刪除 Configuration Manager 用戶端快取。  

-   清除為 Configuration Manager 用戶端指派的網站變數。  

-   刪除所有本機 Configuration Manager 原則。  

-   移除 Configuration Manager 用戶端的受信任根金鑰。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

##  <a name="a-namebkmkpreparewindowsforcapturea-prepare-windows-for-capture"></a><a name="BKMK_PrepareWindowsforCapture"></a> 準備 Windows 以進行擷取  
 使用 [準備 Windows 以進行擷取]  工作順序步驟，以指定在參照電腦上擷取作業系統映像時，所要使用的 Sysprep 選項。 此工作順序動作會執行 Sysprep，然後使電腦重新開機至為工作順序指定的 Windows PE 開機映像。 參照電腦絕不能加入網域中，才能順利完成這個動作。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的相關資訊，請參閱 [Prepare Windows for Capture Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_PrepareWindowsCapture)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **自動建置大型存放驅動程式清單**  
 選取此選項，讓 Sysprep 自動從參照電腦建置大型存放驅動程式清單。 此選項會在參照電腦上的 sysprep.inf 檔案中，啟用 [建置大型存放驅動程式] 選項。 如需此設定的詳細資訊，請參閱 Sysprep 說明文件。  

 **不要重設啟動旗標**  
 選取此選項可防止 Sysprep 重設產品啟動旗標。  

##  <a name="a-namebkmkpreprovisionbitlockera-pre-provision-bitlocker"></a><a name="BKMK_PreProvisionBitLocker"></a> 預先佈建 BitLocker  
 使用 [預先佈建 BitLocker]  工作順序步驟，以在 Windows PE 中時，在磁碟機上啟用 BitLocker。 由於只加密已使用的磁碟空間，因此加密速度較快。 您可以在安裝作業系統之後，使用 [啟用 BitLocker](#BKMK_EnableBitLocker) 工作順序步驟來套用金鑰管理選項。 此步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。  

> [!IMPORTANT]  
>  若要預先佈建 BitLocker，您必須部署至少 Windows 7 的作業系統，而且電腦上必須支援並啟用 TPM。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 指定詳細的資訊來描述此步驟中所採取的動作。  

 **將 BitLocker 套用至指定的磁碟機**  
 指定您要啟用 BitLocker 的磁碟機。 只會將磁碟機上已使用的空間加密。  

 **針對沒有 TPM 的電腦，或是未啟用 TPM 時，略過此步驟**  
 選取此選項，可在電腦硬體不支援 TPM，或是未啟用 TPM 時，略過磁碟機加密。 例如，當您將作業系統部署至虛擬機器時，就可以使用此選項。  

##  <a name="a-namebkmkreleasestatestorea-release-state-store"></a><a name="BKMK_ReleaseStateStore"></a> 和 [釋放狀態存放區]  
 使用 [釋放狀態存放區]  工作順序步驟，以通知狀態移轉點，已完成擷取或還原動作。 此步驟可搭配使用 [要求狀態存放區] 、[擷取使用者狀態] 和 [還原使用者狀態]  工作順序步驟，以使用狀態移轉點和使用者狀態移轉工具 (USMT) 來移轉使用者狀態資料。  

 如需在部署作業系統時管理使用者狀態的詳細資訊，請參閱[管理使用者狀態](../get-started/manage-user-state.md)。  

 如果您在 [要求狀態存放區]   工作順序步驟中，要求存取狀態移轉點來擷取使用者狀態，這個步驟會通知狀態移轉點，擷取程序已完成，而且使用者狀態資料可供還原。 狀態移轉點會為所擷取的狀態設定存取控制權限，使其只能讓進行還原的電腦存取 (唯讀)。  

 如果您在 [要求狀態存放區]  工作順序步驟中，要求存取狀態移轉點來還原使用者狀態，此工作順序步驟會通知狀態移轉點還原程序已完成。 此時，您為狀態移轉點設定的任何保留設定都會啟動。  

> [!IMPORTANT]  
>  最佳作法是在 [要求狀態存放區]  步驟與 [釋放狀態存放區]  步驟之間的任何工作順序步驟上，設定 [發生錯誤時繼續]  ，讓每個 [要求狀態存放區]  工作順序動作都有相對應的 [釋放狀態存放區]  工作順序動作。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的相關資訊，請參閱 [Release State Store Sequence Action Variables](task-sequence-action-variables.md#BKMK_ReleaseStateStore)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

##  <a name="a-namebkmkrequeststatestorea-request-state-store"></a><a name="BKMK_RequestStateStore"></a> 工作順序步驟來搭配 [要求狀態存放區]  
 使用 [要求狀態存放區]  工作順序步驟，以要求在從電腦擷取狀態，或是將狀態還原至電腦時，能夠存取狀態移轉點。  

 如需在部署作業系統時管理使用者狀態的詳細資訊，請參閱[管理使用者狀態](../get-started/manage-user-state.md)。  

 您可以使用 [要求狀態存放區]  工作順序步驟來搭配 [釋放狀態存放區] 、[擷取使用者狀態] 和 [還原使用者狀態]  工作順序步驟，以使用狀態移轉點和使用者狀態移轉工具 (USMT) 來移轉電腦狀態。  

> [!NOTE]  
>  如果您才剛建立新的狀態移轉點網站角色 (SMP)，可能需要一個小時，才能用於使用者狀態存放作業。 若要加速 SMP 的可用性，您可以調整任何狀態移轉點內容設定，以觸發網站控制檔案更新。  

 此工作順序步驟可以在標準作業系統和適用於離線 USMT 的 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的相關資訊，請參閱 [Request State Store Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_RequestState)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **從電腦擷取狀態**  
 可尋找符合狀態移轉點設定 (最大用戶端數目和最小可用磁碟空間數量) 中設定之最小需求的狀態移轉點，但不保證在進行狀態移轉時，會有足夠的可用空間。 選取此選項將會要求存取狀態移轉點，以從電腦擷取使用者狀態和設定。  

 如果 Configuration Manager 站台已啟用多個狀態移轉點，此工作順序步驟會尋找具有可用磁碟空間的狀態移轉點，它會在站台的管理點中查詢狀態移轉點清單，然後評估每個狀態移轉點，直到找到符合最小需求的狀態移轉點。  

 **從另一部電腦還原狀態**  
 選取此選項來要求存取狀態移轉點，以將先前擷取的使用者狀態和設定還原至目的地電腦。  

 如果 Configuration Manager 站台有多個狀態移轉點，此工作順序步驟會尋找已為目的地電腦儲存電腦狀態的狀態移轉點。  

 **重試次數**  
 此工作順序步驟將會嘗試尋找適當狀態移轉點的次數，超過即失敗。  

 **重試延遲 (以秒為單位)**  
 工作順序步驟嘗試重試的時間間隔，以秒為單位。  

 **如果電腦帳戶無法連接到狀態存放區，則使用網路存取帳戶。**  
 指定如果 Configuration Manager 用戶端無法使用電腦帳戶來存取 SMP 狀態存放區，將會使用 Configuration Manager 網路存取帳戶認證來連線至狀態移轉點。 這個選項比較不安全，因為其他電腦可以使用網路存取帳戶來存取您存放的狀態，但是如果目的地電腦未加入網域，可能就會需要這個選項。  

##  <a name="a-namebkmkrestartcomputera-restart-computer"></a><a name="BKMK_RestartComputer"></a> 重新啟動電腦  
 使用 [重新啟動電腦]  工作順序步驟，可重新啟動執行工作順序的電腦。 重新啟動之後，電腦將會自動繼續執行工作順序中的下一個步驟。  

 此步驟可以在標準作業系統或 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的詳細資訊，請參閱[重新啟動電腦工作順序動作變數](task-sequence-action-variables.md#BKMK_RestartComputer)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **指派給此工作順序的開機映像**  
 為目的地電腦選取此選項，以使用指派給工作順序的開機映像。 開機映像將會用來執行在 Windows PE 中執行的後續工作順序步驟。  

 **目前已安裝的預設作業系統**  
 為目標電腦選取此選項，以重新開機至已安裝的作業系統。  

 **重新啟動之前通知使用者**  
 選取此選項對使用者顯示通知，指出將會重新啟動目的地電腦。 預設會選取這個選項。  

 **通知訊息**  
 輸入在重新啟動目的地電腦之前，要對使用者顯示的通知訊息。  

 **訊息顯示逾時**  
 指定在重新啟動目的地電腦之前，要給使用者多少時間 (以秒為單位)。 預設時間量為六十 (60) 秒。  

##  <a name="a-namebkmkrestoreuserstatea-restore-user-state"></a><a name="BKMK_RestoreUserState"></a> 還原使用者狀態  
 使用 [還原使用者狀態]  工作順序步驟，以初始化使用者狀態移轉工具 (USMT)，將使用者狀態和設定還原至目的地電腦。 這個工作順序步驟會與 [擷取使用者狀態]  工作順序步驟搭配使用。  

 如需在部署作業系統時管理使用者狀態的詳細資訊，請參閱[管理使用者狀態](../get-started/manage-user-state.md)。  

 如果您想要將狀態設定儲存至 Configuration Manager 站台中的狀態移轉點，或是從該點還原設定，您也可以搭配使用 [還原使用者狀態] 工作順序步驟與 [要求狀態存放區] 和 [釋放狀態存放區] 工作順序步驟。 若使用 USMT 3.0 和以上版本，此選項一律會使用由 Configuration Manager 產生和管理的加密金鑰來解密 USMT 狀態存放區。  

 [還原使用者狀態]  工作順序步驟可讓您控制最常用的 USMT 選項的有限子集。 您可以使用 OSDMigrateAdditionalRestoreOptions 工作順序變數來指定其他命令列選項。  

> [!IMPORTANT]  
>  如果您使用 [還原使用者狀態]  工作順序步驟來進行與作業系統部署案例無關的事項，請在 [還原使用者狀態] [](#BKMK_RestartComputer) 工作順序步驟後面，緊接著加入 **Restart Computer** 工作順序步驟。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的相關資訊，請參閱 [Restore User State Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_RestoreUserState)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 指定進一步的詳細資訊，描述在此步驟中所採取的動作。  

 **使用者狀態移轉工具套件**  
 輸入 Configuration Manager 套件，其中包含可讓此步驟在還原使用者狀態和設定時使用的 USMT 版本。 此套件不需要程式。 執行工作順序步驟時，工作順序將會使用您指定之套件中的 USMT 版本。 依據您要將狀態還原至哪個作業系統的架構，指定包含 32 位元或 x64 版 USMT 的套件。  

 **以標準選項還原所有擷取的使用者設定檔**  
 以標準選項還原所擷取的使用者設定檔。 若要自訂所要還原的選項，請選取 [自訂使用者設定檔擷取] 。  

 **自訂如何還原使用者設定檔**  
 可讓您自訂您要還原至目的地電腦的檔案。 按一下 [檔案]  ，以指定您要在 USMT 套件中用來還原使用者設定檔的組態檔。 若要新增組態檔，請在 [檔案名稱]  方塊中輸入檔案名稱，然後按一下 [新增] 。 將用於此作業的組態檔會列示在 [檔案] 窗格中。 您指定的 .xml 檔案會定義將還原哪些使用者檔案。  

 **還原本機電腦使用者設定檔**  
 還原本機電腦使用者 (不是網域使用者) 設定檔。 您必須指派新密碼給所還原的本機使用者帳戶，因為原始的本機使用者帳戶密碼無法移轉。 在 [密碼]  方塊中輸入新密碼，然後在 [確認密碼]  方塊中確認密碼。  

 **無法還原部分檔案時仍繼續**  
 即使某些檔案無法還原，仍繼續還原使用者狀態和設定。 這個選項預設為啟用。 如果您停用此選項，並且在還原檔案時遇到錯誤，工作順序步驟將會立即結束，並顯示失敗，而且並不是所有檔案都會還原。  

 **啟用詳細資訊記錄**  
 啟用此選項可產生較詳細的記錄檔資訊。 還原狀態時會產生 Loadstate.log 記錄檔，且根據預設會儲存在 \windows\system32\ccm\logs 資料夾的工作順序記錄檔資料夾中。  

##  <a name="a-namebkmkruncommandlinea-run-command-line"></a><a name="BKMK_RunCommandLine"></a> 執行命令列  
 使用 [執行命令列]  工作順序步驟，以執行所指定的命令列。  

 此步驟可以在標準作業系統或 Windows PE 中執行。 如需這項工作順序動作之工作順序變數的相關資訊，請參閱 [Run Command Line Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_RunCommand)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述所執行的命令列。  

 **說明**  
 指定較詳細的資訊，描述所執行的命令列。  

 **Command line**  
 指定所執行的命令列。 此為必要欄位。 最好是包含副檔名，例如 .vbs 和 .exe。 包含所有必要的設定檔案、命令列選項或參數。  

 如果檔案名稱未指定副檔名，Configuration Manager 會嘗試使用 .com、.exe 和 .bat。 如果檔案名稱的副檔名不是可執行檔，Configuration Manager 會嘗試套用本機關聯。 例如，如果命令列是 readme.gif，則 Configuration Manager 會啟動目的地電腦上指定的應用程式，以開啟 .gif 檔案。  

 範例：  

 **setup.exe /a**  

 **cmd.exe /c copy Jan98.dat c:\sales\Jan98.dat**  

> [!NOTE]  
>  命令列動作，例如上述範例所示的輸出重新導向、管道或複製，前面必須加上 **cmd.exe /c** 命令，才能順利執行。  

 **停用 64 位元檔案系統重新導向**  
 根據預設，在 64 位元作業系統上執行時，會使用 WOW64 檔案系統重新導向器來尋找和執行命令列中的可執行檔，這樣才能找到 32 位元版本的作業系統可執行檔和 DLL。  選取這個選項會停用 WOW64 檔案系統重新導向器，這樣才能找到原生 64 位元版本的作業系統可執行檔和 DLL。  在 32 位元作業系統上執行時，選取這個選項沒有作用。  

 **啟動位置**  
 指定程式的可執行檔資料夾，最多 127 個字元。 此資料夾可以是目的地電腦上的絕對路徑，或是含有套件之發佈點資料夾的相對路徑。 此為選擇性欄位。  

 範例：  

 **c:\officexp**  

 **i386**  

> [!NOTE]  
>  [瀏覽]  按鈕會瀏覽本機電腦中的檔案和資料夾，所以您以這種方式選取的任何項目也必須存在於目的地電腦上的相同位置，並使用相同的檔案和資料夾名稱。  

 **套件**  
 當您在命令列上指定目的地電腦中不存在的檔案或程式時，請選取此選項來指定含有適當檔案的 Configuration Manager 套件。 此套件不需要程式。 如果指定的檔案存在於目的地電腦上，則不需要這個選項。  

 **逾時**  
 指定一個值，用來表示 Configuration Manager 將允許命令列執行多久。 這個值可以從 10 分鐘到 999 分鐘。 預設值為 15 分鐘。  

 預設會停用這個選項。  

> [!IMPORTANT]  
>  如果您輸入的值無法提供足夠的時間讓 [執行命令列] 工作順序步驟順利完成，該工作順序步驟將會失敗，而且整個工作順序可能會因為其他控制設定而失敗。 如果超過逾時值，Configuration Manager 將會終止命令列程序。  

 **以下列帳戶執行這個步驟**  
 指定以 Windows 使用者帳戶而非本機系統帳戶來執行命令列。  

> [!NOTE]  
>  當您為此步驟指定另一個帳戶，而且是發生在作業系統安裝步驟之後，您就必須先將該帳戶新增到電腦，才能執行簡單的指令碼或命令，而且必須還原 Windows 使用者帳戶的設定檔，才能執行更複雜的程式，例如 MSI。  

 **帳戶**  
 針對此動作所要執行之工作順序中的命令列工作，指定 [以 Windows 使用者帳戶執行]。 將會以指定帳戶的權限來執行命令列。 按一下 [設定]  ，以指定本機使用者或網域帳戶。  

> [!IMPORTANT]  
>  如果在 Windows PE 時，執行指定使用者帳戶的 [執行命令列]  工作順序動作，該動作將會失敗，因為 Windows PE 無法加入網域。 該失敗會記錄在 smsts.log 檔案中。  

##  <a name="a-namebkmkrunpowershellscripta-run-powershell-script"></a><a name="BKMK_RunPowerShellScript"></a> 執行 PowerShell 指令碼  
 使用 [執行 PowerShell 指令碼]  工作順序步驟來執行指定的 PowerShell 指令碼。  

 此步驟可以在標準作業系統或 Windows PE 中執行。 若要在 Windows PE 中執行此步驟，必須在開機映像中啟用 PowerShell。 您可以從開機映像內容中的 [選用元件]  索引標籤來啟用 Windows PowerShell (WinPE PowerShell)。 如需如何修改開機映像的詳細資訊，請參閱[管理開機映像](../get-started/manage-boot-images.md)。  

> [!NOTE]  
>  在 Windows Embedded 作業系統上，預設不會啟用 PowerShell。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述所執行的命令列。  

 **說明**  
 指定較詳細的資訊，描述所執行的命令列。  

 **套件**  
 指定包含 PowerShell 指令碼的 Configuration Manager 套件。 一個套件可以包含多個 PowerShell 指令碼。  

 **指令碼名稱**  
 指定所要執行的 PowerShell 指令碼名稱。 此為必要欄位。  

 **參數**  
 指定要傳遞至 Windows PowerShell 指令碼的參數。 設定參數，就好像您是從命令列將其加入 Windows PowerShell 指令碼中一樣。  

> [!IMPORTANT]  
>  提供指令碼所使用的參數，而不是要用於 Windows PowerShell 命令列。  
>   
>  下列範例包含有效的參數：  
>   
>  **-MyParameter1 MyValue1 -MyParameter2 MyValue2**  
>   
>  下列範例包含無效的參數： 粗體項目是 Windows PowerShell 命令列參數 (-nologo 和 -executionpolicy unrestricted)，而非用於指令碼。  
>   
>  **-nologo-executionpolicy unrestricted-File MyScript.ps1 -MyParameter1 MyValue1 -MyParameter2 MyValue2**  

 **PowerShell 執行原則**  
 選取 PowerShell 執行原則，可讓您判斷將允許哪些 Windows PowerShell 指令碼 (如果有的話) 在電腦上執行。 選擇下列其中一個執行原則：  

-   **所有已簽署項目**：只能執行由受信任的發行者簽署的指令碼。  

-   **未定義**：未定義任何執行原則。 。  

-   **略過**：載入所有組態檔，並執行所有指令碼。 如果您執行從網際網路下載的未簽署指令碼，在其執行之前，不會提示您提供權限。  

> [!IMPORTANT]  
>  PowerShell 1.0 不支援 [未定義] 和 [略過] 執行原則。  

##  <a name="a-namebkmksetdynamicvariablesa-set-dynamic-variables"></a><a name="BKMK_SetDynamicVariables"></a> 設定動態變數  
 使用 [設定動態變數]  工作順序步驟來執行下列作業：  

1.  從其所在的電腦和環境收集資訊，然後以該資訊來設定所指定的工作順序變數。  

2.  評估所定義的規則，並根據針對評估為 True 的規則而設定的變數和值，設定工作順序變數。  

 工作順序會自動設定下列唯讀的工作順序變數：  

-   _SMSTSMake  

-   _SMSTSModel  

-   _SMSTSMacAddresses  

-   _SMSTSIPAddresses  

-   _SMSTSSerialNumber  

-   _SMSTSAssetTag  

-   _SMSTSUUID  

 此步驟可以在標準作業系統或 Windows PE 中執行。 如需工作順序變數的詳細資訊，請參閱[工作順序動作變數](task-sequence-action-variables.md)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 針對此工作順序步驟，指定簡短的使用者定義名稱。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **動態規則和變數**  
 若要設定要用在工作順序中的動態變數，您可以加入規則，然後針對您為規則指定的每個變數，各指定一個值，或加入一或多個要設定的變數，而不加入規則。 當您加入規則時，可以從下列規則類別中選擇：  

-   **電腦**：使用這個規則類別來評估 [資產] 標籤、UUID、序號或 MAC 位址的值。 您可以設定多個值，如果有任何值為 true，該規則將會評估為 true。 例如，不論 MAC 位址是否等於 26-78-13-5A-A4-22，如果序號是 5892087，下列規則就會評估為 true。  

     `IF Serial Number = 5892087 OR MAC address = 26-78-13-5A-A4-22 THEN`  

-   **位置**：使用這個規則類別來評估預設閘道的值。  

-   **製造商和型號**：使用這個規則類別來評估電腦製造商和型號的值。 製造商和型號都必須評估為 true，規則才會評估為 true。  

-   **工作順序變數**：使用這個規則類別來新增工作順序變數、條件和要評估的值。 當為變數設定的值符合指定的條件時，規則會評估為 true。  

 您可以指定要針對評估為 true 的規則設定的一或多個變數，或是設定變數，而不使用規則。 您可以從現有的變數選取，或建立自訂變數。  

-   **現有的工作順序變數**：使用這項設定，從現有的工作順序變數清單中選取一或多個變數。 無法選取陣列變數。  

-   **自訂工作順序變數**：使用這項設定來定義自訂工作順序變數。 您也可以指定現有的工作順序變數。 這很適合用來指定現有的變數陣列，例如 OSDAdapter，因為變數陣列不在現有的工作順序變數清單中。  

 在選取規則的變數之後，您必須為每個變數提供值。 當規則評估為 true 時，變數會設為所指定的值。 您可以針對每個變數，選取 [祕密值]  來隱藏變數的值。 根據預設，某些現有的變數會隱藏值，例如 OSDCaptureAccountPassword 工作順序變數。  

> [!IMPORTANT]  
>  如果使用 [設定動態變數] 步驟來匯入工作順序，並且為變數的值選取 [祕密值]  ，當您匯入工作順序時，就會移除該值。 因此，在您匯入工作順序之後，必須重新輸入動態變數的值。  

##  <a name="a-namebkmksettasksequencevariablea-set-task-sequence-variable"></a><a name="BKMK_SetTaskSequenceVariable"></a> 設定工作順序變數  
 使用 [設定工作順序變數]  工作順序步驟來設定要與工作順序搭配使用的變數值。  

 此步驟可以在標準作業系統或 Windows PE 中執行。 工作順序變數會被工作順序動作讀取，並指定那些動作的行為。 如需特定工作順序變數的詳細資訊，請參閱[工作順序動作變數](task-sequence-action-variables.md)。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 針對此工作順序步驟，指定簡短的使用者定義名稱。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **Task sequence variable**  
 工作順序變數的使用者定義名稱。  

 **值**  
 與工作順序變數相關聯的值。 該值可以是 %<變數名稱\>% 語法中的另一個工作順序變數。  

##  <a name="a-namebkmksetupwindowsandconfigmgra-setup-windows-and-configmgr"></a><a name="BKMK_SetupWindowsandConfigMgr"></a> varname  
 使用 [設定 Windows 和 ConfigMgr]  工作順序步驟來執行從 Windows PE 到新作業系統的轉換。 此工作順序步驟是部署任何作業系統的必要部分。 它會將 Configuration Manager 用戶端安裝到新的作業系統中，並準備好讓工作順序繼續在新的作業系統中執行。  

 此步驟只會在 Windows PE 中執行。 它不會在標準作業系統中執行。 如需此工作順序動作的工作順序變數詳細資訊，請參閱[設定 Windows 和 ConfigMgr 工作順序動作變數](task-sequence-action-variables.md#BKMK_SetupWindows)。  

 [設定 Windows 和 ConfigMgr]  工作順序動作會以 Windows PE 安裝目錄 X:\Windows 來取代 sysprep.inf 或 unattend.xml 目錄變數，例如 %WINDIR% 和 %ProgramFiles%。 使用這些環境變數來指定的工作順序變數都會被忽略。  

 使用此工作順序步驟來執行下列動作：  

1.  準備工作：Windows PE  

    1.  在 unattend.xml 檔案中執行工作順序變數取代作業。  

    2.  下載包含 Configuration Manager 用戶端的套件，並將它放在已部署的映像中。  

2.  設定 Windows  

    1.  以映像為基礎的安裝。  

        1.  停用映像中的 Configuration Manager 用戶端 (也就是停用 Configuration Manager 用戶端服務的自動啟動)。  

        2.  更新已部署映像中的註冊，以確保已部署的作業系統會以其在參照電腦上的相同磁碟機代號來啟動。  

        3.  在已部署的作業系統中重新啟動。  

        4.  執行 Windows 迷你安裝時，會使用先前指定的 sysprep.inf 或 unattend.xml 檔案，這些檔案會抑制所有使用者互動。 注意：如果 [套用網路設定]  指定要加入網域，則該資訊是位在 sysprep.inf 或 unattend.xml 檔案中，且 Windows 迷你安裝會執行網域加入。  

    2.  以 Setup.exe 為基礎的安裝。  遵循一般 Windows 安裝程序來執行 Setup.exe：  

        1.  將稍早 [套用作業系統]  工作順序中指定的作業系統安裝套件，複製到硬碟上。  

        2.  在新部署的作業系統中重新啟動。  

        3.  執行 Windows 迷你安裝時，會使用先前指定的 sysprep.inf 或 unattend.xml 檔案，這些檔案會抑制所有使用者介面設定。 注意：如果 [套用網路設定]  指定要加入網域，則該資訊是位在 sysprep.inf 或 unattend.xml 檔案中，且 Windows 迷你安裝會執行網域加入。  

3.  設定 Configuration Manager 用戶端  

    1.  Windows 迷你安裝完成之後，工作順序會使用 setupcomplete.cmd 來繼續進行。  

    2.  根據在 [套用 Windows 設定]  步驟中選取的選項，啟用或停用本機系統管理員帳戶。  

    3.  使用先前下載的套件 (1.b)，以及工作順序編輯器中指定的安裝內容，來安裝 Configuration Manager 用戶端。 用戶端是以「佈建模式」安裝，以防止它處理新的原則要求，直到工作順序完成。  

    4.  等候用戶端完全正常運作。  

    5.  如果電腦是在啟用 [網路存取保護] 的環境中運作，用戶端會檢查並安裝任何必要的更新，以在工作順序會繼續執行之前，準備好所有必要的更新。  

4.  工作順序會繼續執行其下一個步驟。  

> [!NOTE]  
>  [設定 Windows 和 ConfigMgr]  工作順序動作負責在新安裝的電腦上執行群組原則。 工作順序完成之後會套用群組原則。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   如果執行步驟時發生錯誤，不要選取讓這個工作順序繼續進行。 如果發生錯誤，不論是否選取這項設定，工作順序都會失敗。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 指定簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 指定額外的資訊來描述此步驟中所採取的動作。  

 **用戶端封裝**  
 指定此工作順序步驟將要使用的 Configuration Manager 用戶端安裝套件。 按一下 [瀏覽]，並選取您要用來安裝 Configuration Manager 用戶端的用戶端安裝套件。  

 **使用進入生產階段前用戶端封裝 (可用時)**  
 指定如果有進入生產階段前用戶端封裝可用，則工作順序步驟會使用這個封裝，而不是生產用戶端封裝。 一般而言，進入生產階段前用戶端是正在生產環境中測試的較新版本。 按一下 [瀏覽]，並選取您要用來安裝 Configuration Manager 用戶端的進入生產階段前用戶端安裝套件。  

 **安裝內容**  
 工作順序動作會自動指定網站指派和預設組態。 您可以使用此欄位來指定安裝用戶端時，所要使用的任何其他安裝內容。 若要輸入多個安裝內容，請以空格分隔。  

 您可以指定要在用戶端安裝期間使用的命令列選項。 例如，您可以輸入 **/skipprereq: silverlight.exe** ，以通知 CCMSetup.exe 不要安裝 Microsoft Silverlight 必要條件。 如需 CCMSetup.exe 可用命令列選項的詳細資訊，請參閱[關於用戶端安裝內容](../../core/clients/deploy/about-client-installation-properties.md)。  

##  <a name="a-namebkmkupgradeosa-upgrade-operating-system"></a><a name="BKMK_UpgradeOS"></a> 升級作業系統  
 使用 [升級作業系統]  工作順序步驟，將現有的 Windows 7、Windows 8、Windows 8.1 或 Windows 10 作業系統升級為 Windows 10。  

 此工作順序步驟只會在標準作業系統中執行。 它不會在 Windows PE 中執行。  

### <a name="details"></a>詳細資料  
 在這個步驟的 [內容]  索引標籤上，您可以設定本節所描述的設定。  

 此外，您可以使用 [選項]  索引標籤來執行下列動作：  

-   停用此步驟。  

-   指定在執行此步驟時，如果發生錯誤，工作順序是否繼續。  

-   指定執行此步驟時，所必須符合的條件。  

 **Name**  
 簡短的使用者定義名稱，描述在此步驟中所採取的動作。  

 **說明**  
 以較詳細的資訊來描述此步驟中所採取的動作。  

 **升級封裝**  
 選取這個選項，可指定要用於升級的 Windows 10 作業系統升級封裝。  

 **來源路徑**  
 指定所要使用之 Windows 10 媒體的本機或網路路徑 (對應至 /installFrom 命令列選項)。 您也可以指定變數，例如 %mycontentpath% 或 %DPC01%。 當您使用變數來表示來源路徑時，您必須在此工作順序初期指定變數。 例如，如果您使用工作順序中的 [ [下載封裝內容](#BKMK_DownloadPackageContent) ] 步驟，您可以指定表示作業系統升級封裝位置的變數。 然後，您可以使用該變數來表示這個步驟中的來源路徑。  

 **版本**  
 指定要用於升級之作業系統媒體的內部版本。  

 **產品金鑰**  
 指定要套用至升級程序的產品金鑰  

 **在升級期間將下列驅動程式內容提供給 Windows 安裝程式**  
 選取這項設定，可在升級程序期間將驅動程式新增至目的電腦 (對應至 /InstallDriver 命令列選項)。 這些驅動程式必須與 Windows 10 相容。 請指定下列其中一個選項：  

-   **驅動程式封裝**：按一下 [瀏覽]  ，然後從清單中選取現有的驅動程式封裝。  

-   **分段內容**：選取這個選項，可指定驅動程式封裝的位置。 您可以指定本機資料夾、網路路徑或工作順序變數。 當您使用變數來表示來源路徑時，您必須在此工作順序初期指定變數。 例如，藉由使用 [ [Download Package Content](task-sequence-steps.md#BKMK_DownloadPackageContent) ] 步驟。  

 **逾時 (分鐘)**  
 指定安裝程式必須執行，否則 Configuration Manager 將無法完成工作順序步驟的間隔分鐘數。  

 **執行 Windows 安裝程式相容性掃描而不啟動升級**  
 指定此選項可執行 Windows 安裝程式相容性掃描，而不啟動升級程序 (對應至 /Compat ScanOnly 命令列選項)。 當您使用這個選項時，仍然必須部署整個安裝來源。 安裝程式會傳回結束代碼作為掃描的結果。 下表提供一些較常見的結束代碼。  

|結束碼|詳細資料|  
|-|-|  
|MOSETUP_E_COMPAT_SCANONLY (0xC1900210)|沒有相容性問題 (「成功」)。|  
|MOSETUP_E_COMPAT_INSTALLREQ_BLOCK (0xC1900208)|可採取動作的相容性問題。|  
|MOSETUP_E_COMPAT_MIGCHOICE_BLOCK (0xC1900204)|無法使用所選的移轉選項。 例如，從 Enterprise 升級為 Professional。|  
|MOSETUP_E_COMPAT_SYSREQ_BLOCK (0xC1900200)|不適用於 Windows 10。|  
|MOSETUP_E_COMPAT_INSTALLDISKSPACE_BLOCK (0xC190020E)|可用磁碟空間不足。|  

 如需這個參數的詳細資訊，請參閱 [Windows 安裝程式命令列選項](https://msdn.microsoft.com/library/windows/hardware/dn938368\(v=vs.85\).aspx)。  

 **忽略任何可解除的相容性訊息**  
 指定安裝程式完成安裝，並忽略任何可解除的相容性訊息 (對應至 /Compat IgnoreWarning 命令列選項)。  

 **使用 Windows Update 動態更新 Windows 安裝程式**  
 指定安裝程式是否將執行動態更新作業，例如搜尋、下載及安裝更新 (對應至 /DynamicUpdate 命令列選項)。 這項設定與 Configuration Manager 軟體更新不相容，但可在使用 WSUS (獨立) 或 Windows Update 處理更新時加以啟用。  

 **覆寫原則並使用預設的 Microsoft Update**：選取這項設定可即時暫時覆寫本機原則，以執行動態更新作業，並讓電腦從 Windows Update 取得更新。  



<!--HONumber=Nov16_HO1-->


