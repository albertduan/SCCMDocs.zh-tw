---
title: "自動化工作規劃考量 | Configuration Manager"
description: "在 System Center Configuration Manager 中自動化工作之前進行規劃。"
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology:
- configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: fc497a8a-3c54-4529-8403-6f6171a21c64
caps.latest.revision: 13
caps.handback.revision: 0
author: Dougeby
ms.author: dougeby
manager: angrobe
translationtype: Human Translation
ms.sourcegitcommit: 1134bb2f04152288e72d40b1b1083f415cb4e900
ms.openlocfilehash: a439d847adb129a341b33be8e1a1674c72184e77


---
# <a name="planning-considerations-for-automating-tasks-in-system-center-configuration-manager"></a>System Center Configuration Manager 的自動化工作規劃考量

*適用於：System Center Configuration Manager (最新分支)*

您可以建立工作順序，以在 System Center Configuration Manager 環境中自動化工作。 這些工作範圍涵蓋擷取參照電腦上的作業系統，到將作業系統部署到一部或多部目的地電腦。 工作順序的動作，會在順序的個別步驟中定義。 當工作順序執行時，每個步驟的動作都是在本機系統內容的命令列層級執行，不需要使用者介入。 下列各節可協助規劃在 Configuration Manager 中自動化工作。

##  <a name="a-namebkmktsstepsactionsa-task-sequence-steps-and-actions"></a><a name="BKMK_TSStepsActions"></a> 工作順序的步驟和動作  
 步驟是工作順序的基本元件。 它們可能包含設定和擷取參照電腦之作業系統的命令，或包含在目的地電腦上安裝作業系統、驅動程式、Configuration Manager 用戶端和軟體的命令。 工作順序的命令是由步驟的動作所定義。 其中有兩種類型的動作。 一種您使用命令列字串定義的動作，稱為自訂動作。 另一種是由 Configuration Manager 預先定義的動作，稱為內建動作。 工作順序可以執行任何組合的自訂和內建動作。  

 工作順序步驟也可以包含控制步驟行為的條件，例如若發生錯誤時是要停止工作順序，或繼續工作順序。 新增條件的方式是在步驟中包含工作順序步驟。 例如，您可以使用 **SMSTSLastActionRetCode** 變數測試上一個步驟的條件。 變數可以加入至單一步驟或步驟的群組。  

 工作順序步驟會依照順序執行，包括步驟的動作和指派給步驟的任何動作。 當 Configuration Manager 開始處理工作順序步驟時，會等到上一個動作完成後，才啟動下一個步驟。 當工作順序的所有步驟皆已完成，或者所有步驟完成前，有某個失敗的步驟導致 Configuration Manager 停止執行工作順序時，工作順序就會被視為已完成。 例如，若工作順序的步驟在發佈點上找不到參照映像或套件，除非失敗的步驟內含當發生錯誤時仍繼續執行的條件，否則工作步驟會包含不完整的參照，而 Configuration Manager 會停止在該點上執行的工作順序。  

> [!IMPORTANT]  
>  根據預設，若某個步驟或動作失敗，則工作順序會失敗。 如果您想要在步驟失敗後繼續執行工作順序，請編輯工作順序，並按一下 **[選項]** 索引標籤，然後選取 **[發生錯誤時仍繼續]**。  

 如需可新增至工作順序之步驟的詳細資訊，請參閱[工作順序步驟](../understand/task-sequence-steps.md)。  

##  <a name="a-namebkmktsgroupsa-task-sequence-groups"></a><a name="BKMK_TSGroups"></a> 工作順序群組  
 [群組] 是工作順序內的多個步驟。 工作順序群組是由名稱、選擇性描述，以及其他在工作順序繼續執行下一個步驟前評估為單位的選用條件所組成。 群組可以彼此嵌入，同時群組可以包含混合的步驟和子群組。 群組非常適用於合併多個共用一般條件的步驟。  

> [!IMPORTANT]  
>  根據預設，當群組中的任何步驟或內嵌群組失敗時，工作順序群組也會失敗。 如果您想要在步驟或內嵌群組失敗後繼續執行工作順序，請編輯工作順序，並按一下 **[選項]** 索引標籤，然後選取 **[發生錯誤時仍繼續]**。  

 下表顯示當您組成步驟時，[發生錯誤時仍繼續] 選項的運作方式。  

 在此範例中，有兩個工作順序的群組，每個群組包含三個工作順序步驟。  

|工作順序群組或步驟|發生錯誤時仍繼續設定|  
|---------------------------------|-------------------------------|  
|**工作順序群組 1**|**[發生錯誤時仍繼續]** 已選取。|  
|工作順序步驟 1|**[發生錯誤時仍繼續]** 已選取。|  
|工作順序步驟 2|未設定。|  
|工作順序步驟 3|未設定。|  
|**工作順序群組 2**|未設定。|  
|工作順序步驟 4|未設定。|  
|工作順序步驟 5|未設定。|  
|工作順序步驟 6|未設定。|  

-   如果工作順序步驟 1 失敗，工作順序會繼續執行工作順序步驟 2。  

-   如果工作順序步驟 2 失敗，工作順序不會執行工作順序步驟 3，但會繼續執行工作順序步驟 4 和 5 (屬於不同工作順序群組)。  

-   如果工作順序步驟 4 失敗，則不會執行其他步驟，工作順序會因為 [發生錯誤時仍繼續] 設定未針對工作步驟群組 2 配置而失敗。  

 雖然群組名稱不一定要是唯一值，但您必須指派名稱給工作順序群組。 您也可以為工作順序群組提供選擇性描述。  

##  <a name="a-namebkmktsvariablesa-task-sequence-variables"></a><a name="BKMK_TSVariables"></a> 工作順序變數  
 工作順序變數是一組成對的名稱和值，為電腦提供設定和作業系統部署設定、作業系統和 Configuration Manager 用戶端電腦上的使用者狀態設定工作。 工作順序變數提供一種機制，可設定及自訂工作順序中的步驟。  

 當您執行工作順序時，許多工作順序設定會儲存為環境變數。 您可以存取或變更內建工作順序變數的值，也可以建立新的工作順序變數，以自訂工作順序在目的地電腦上執行的方式。  

 您可以在工作順序環境中使用工作順序變數，以執行下列動作：  

-   設定工作順序動作的設定  

-   為工作順序步驟提供命令列引數  

-   評估判斷工作順序或群組是否執行的條件  

-   提供工作順序中使用的自訂指令碼值  

 例如，您可能有一個工作順序，其中包含 [加入網域或工作群組] 工作順序步驟。 工作順序可能會部署至不同的集合，其中集合的成員資格是由網域成員資格所判斷。 在該情況下，您可以為每個集合的網域名稱指定每個集合工作順序變數，然後使用該工作順序變數在工作順序中提供適當的網域名稱。  

###  <a name="a-namebkmktscreatevariablesa-create-task-sequence-variables"></a><a name="BKMK_TSCreateVariables"></a> 建立工作順序變數  
 您可以新增工作順序變數，以自訂和控制工作順序中的步驟。 例如，您可以建立工作順序變數，以覆寫內建工作順序步驟的設定。 您也可以建立自訂工作順序變數，以便在工作順序中與條件、命令列或自訂步驟搭配使用。 當您建立工作順序變數時，工作順序變數和指派的值會保留在工作順序環境中，即使工作順序重新啟動目的地電腦亦相同。 變數及其值可在不同作業系統環境的工作順序中使用。 例如，它可以在完整的 Windows 作業系統和 Windows PE 環境中使用。  

 下表描述建立工作順序變數和其他使用資訊的方法。  

|建立方法|使用方式|  
|-------------------|-----------|  
|使用工作順序編輯器在工作順序步驟中設定欄位|為工作順序步驟指定預設值。 只有在工作順序中執行步驟時，才能存取變數和值。 它們不屬於整體順序環境的一部分，也無法由工作順序中的其他工作順序步驟存取。<br /><br /> 如需內建變數和其相關聯動作的清單，請參閱[工作順序動作變數](../understand/task-sequence-action-variables.md)。|  
|在工作順序中新增設定工作順序變數步驟|當工作順序步驟執行為工作順序的一部分時，在工作順序環境中指定工作順序變數和值。 所有後續的工作順序步驟皆可存取環境變數及其值。|  
|定義每個集合變數|為電腦的集合指定工作順序變數和值。 所有以集合為目標的工作順序，都可存取工作順序變數及其值。|  
|定義每部電腦變數|為特定電腦指定工作順序變數和值。 所有以電腦為目標的工作順序，都可存取工作順序變數及其值。|  
|在 [工作順序媒體精靈] 的 **[自訂]** 頁面上新增工作順序變數|針對從可存取工作順序變數及其值的媒體執行的工作順序，指定工作順序變數和值。|  

 若要覆寫內建工作順序變數的預設值，您必須使用與內建工作順序變數相同的名稱，定義工作順序變數。 如需內建工作順序變數與相關聯動作和使用方式的清單，請參閱[工作順序內建變數](../understand/task-sequence-built-in-variables.md)。  

 您可以使用與建立工作順序變數相同的方法，從工作順序環境刪除工作順序變數。 在此情況下，若要從工作順序環境刪除變數，您可將工作順序變數值設定為空白字串。  

 您可以合併多個方法，將環境工作順序變數設定為相同順序的不同值。 在進階案例中，您可以使用 [工作順序編輯器] 在順序中設定步驟的預設值，然後使用不同的建立方法設定自訂變數值。 下列清單描述當使用一種以上的方法建立工作順序變數時，可用來判斷使用哪些值的規則。  

1.  [設定工作順序變數] 步驟會覆寫其他所有建立方法。  

2.  每部電腦變數優先於每個集合變數。 如果您為每部電腦變數和每個集合變數指定相同的工作順序值名稱，當目的地電腦執行部署工作順序時，會使用每部電腦變數值。  

3.  工作順序可以從媒體執行。 在每個集合或每部電腦變數的位置使用媒體變數。 如果工作順序是從媒體執行，則不會套用及使用每部電腦和每個集合變數。 反之，[工作順序媒體精靈] 的 [自訂] 頁面上所定義的工作順序，會用來設定從媒體執行之工作順序的值。  

4.  如果未在整體順序環境中設定工作順序變數值，內建動作會使用 [工作順序編輯器] 中所設定步驟的預設值。  

 除了覆寫內建工作順序步驟設定的值之外，您也可以建立供工作順序步驟、指令碼、命令列或條件中使用的新環境變數。 當您為新工作順序變數指定名稱時，請依照下列指引進行：  

-   您所指定的工作順序變數名稱可以包含字母、數字、底線字元 (_) 和連字號 (-)。  

-   工作順序變數名稱的最小長度為 1 個字元，最大長度為 256 個字元。  

-   使用者定義的變數開頭必須是字母 (A-Z 或 a-z)。  

-   使用者定義的值名稱開頭不可以是底線字元。 只有唯讀的工作順序變數可以使用底線字元做為開頭字元。  

    > [!NOTE]  
    >  唯讀的工作順序變數可以由工作順序中的工作順序步驟讀取，但無法設定。 例如，您可以在 [執行命令列] 工作順序動作變數的命令列中使用唯讀的工作順序變數，但無法使用 [設定工作順序變數] 動作變數設定唯讀變數。  

-   工作順序變數名稱沒有區分大小寫。 例如，OSDVAR 和 osdvar 表示相同的工作順序變數。  

-   工作順序變數名稱不能使用空白字元做為開頭或結尾字元，或包含內嵌空白字元。 工作順序變數名稱開頭或結尾的空格，會遭到忽略。  

 下表顯示有效及無效之使用者指定的工作順序變數範例。  

|有效之使用者指定的變數 nNames 範例|無效之使用者指定的變數名稱範例|  
|-------------------------------------------------------|----------------------------------------------------------|  
|MyVariable|1Variable<br /><br /> 使用者指定的工作順序變數不能以數字開頭。|  
|My_Variable|MyV@riable<br /><br /> 使用者指定的工作順序變數不能包含 @ 符號。|  
|My_Variable_2|_MyVariable<br /><br /> 使用者指定的工作順序變數不能以底線開頭。|  

 工作序列變數的一般限制：  

-   工作序列變數值不能超過 4,000 個字元。  

-   您無法建立或覆寫唯讀的工作序列變數。 唯讀變數是由以底線字元 (_) 開頭的名稱所指定。 您可以存取工作順序中唯讀工作順序變數的值，但無法變更與其相關聯的值。  

-   工作順序變數值可區分大小寫，端視值的使用狀況而定。 在多數情況下，工作順序變數值並無區分大小寫。 然而，有些值就有區分大小寫，例如包含密碼的變數。  

-   可建立多少工作順序變數並無限制。 不過，變數的數目則受限於工作順序環境的大小。 工作順序環境的大小總計限制為 32 MB。  

###  <a name="a-namebkmktsenvironmentvariablesa-access-environment-variables"></a><a name="BKMK_TSEnvironmentVariables"></a> 存取環境變數  
 在使用前一節的其中一個方法來指定工作順序變數及其值之後，您可以在工作順序中使用環境變數值。 您可以存取內建工作順序變數的預設值、指定新的內建變數值，或在命令列或指令碼中使用自訂工作順序變數。  

 下表簡述工作順序操作，藉由存取工作順序環境變數可執行這些操作。  

|工作順序操作|使用方式|  
|-----------------------------|-----------|  
|設定動作設定值|您可以指定在執行順序時，由變數值提供工作順序步驟設定。<br /><br /> 若要藉由使用工作順序環境變數提供工作順序步驟設定，請使用工作順序編輯器來編輯步驟，並指定變數名稱為欄位值。 變數名稱必須含括在百分比符號 (%) 內，表示其為環境變數。|  
|提供命令列引數|您可以使用環境變數值來指定部分或全部的自訂命令列。<br /><br /> 若要藉由使用環境變數提供命令列設定，請將變數名稱當作 [執行命令列] 工作順序步驟的部分 [命令列] 欄位來使用。 變數名稱必須含括在百分比符號 (%) 內。<br /><br /> 例如，以下命令列使用內建環境變數，將電腦名稱寫入 C:\File.txt。<br /><br /> <br /><br /> **Cmd /C %_SMSTSMachineName% > C:\File.txt**|  
|評估步驟條件|您可以將內建或自訂工作順序環境變數當成部分的工作順序步驟或群組條件來使用。 環境變數值會在執行工作順序步驟或群組之前進行評估。<br /><br /> 若要新增評估變數值的條件，請執行下列操作：<br /><br /> 1.選取您要為其新增條件的步驟或群組。<br />2.在步驟或群組的 [選項] 索引標籤上，從 [新增條件] 下拉式清單中選取 [工作順序變數]。<br />3.在 [工作順序變數] 對話方塊中，指定變數名稱、受測試條件及變數值。|  
|提供自訂指令碼的資訊|在執行工作順序的同時，可藉由使用 Microsoft.SMS.TSEnvironment COM 物件來讀取及寫入工作順序變數。<br /><br /> 以下範例說明查詢 **_SMSTSLogPath** 工作順序變數的 Visual Basic 指令檔，以取得目前的記錄位置。 指令碼也會設定自訂變數。<br /><br /> <br /><br /> **dim osd: set env = CreateObject("Microsoft.SMS.TSEnvironment")**<br /><br /> <br /><br /> **dim logPath**<br /><br /> <br /><br /> **' You can query the environment to get an existing variable.**<br /><br /> **logPath = env("_SMSTSLogPath")**<br /><br /> <br /><br /> **' You can also set a variable in the OSD environment.**<br /><br /> **env("MyCustomVariable") = "varname"**<br /><br /> <br /><br /> 如需如何使用指令碼中之工作順序變數的詳細資訊，請參閱 SDK 文件。|  

###  <a name="a-namebkmkcomputercollectionvariablesa-computer-and-collection-variables"></a><a name="BKMK_ComputerCollectionVariables"></a> 電腦和集合變數  
 您可以將工作順序設定在多部電腦或集合上同時執行。 您可以指定唯一的每部電腦或每個集合資訊，例如指定唯一的作業系統產品金鑰，或是將所有的集合成員加入到指定的網域。  

 您可以將工作順序變數指派到單一電腦或集合。 當工作順序開始在目標電腦或集合上執行時，會將指定值套用到電腦或集合。  

 您可以為單一電腦或集合指定工作順序變數。 工作順序開始在目標電腦或集合上執行時，會將指定的變數套用到可用於工作順序中所有工作順序步驟的環境和值。  

> [!WARNING]  
>  如果您使用每個集合與每部電腦變數所適用的相同變數名稱，電腦變數值的優先順序會高於集合變數。 您指派給集合的工作順序變數優先順序，高於內建工作順序變數。  

 如需如何為電腦與集合建立工作順序變數的詳細資訊，請參閱[為電腦與集合建立工作順序變數](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_CreateTSVariables)。  

###  <a name="a-namebkmktsmediavariablesa-task-sequence-media-variables"></a><a name="BKMK_TSMediaVariables"></a> 工作順序媒體變數  
 您可以針對從媒體執行的工作順序，指定工作順序變數。 當利用媒體部署作業系統時，您可新增工作順序變數，並在建立媒體時指定其值，而變數與變數值則會儲存在媒體上。  

> [!NOTE]  
>  工作順序會儲存在獨立媒體上。 然而，其他所有類型的媒體如已預先設置的媒體，會從管理點擷取工作順序。  

 您可以在工作順序媒體精靈的 [自訂] 頁面指定工作順序變數。 如需如何建立媒體的資訊，請參閱[建立工作順序媒體](../deploy-use/create-task-sequence-media.md)。  

> [!TIP]  
>  工作順序會將套件識別碼和啟動前置命令列 (包括任何工作順序變數的值) 寫入執行 Configuration Manager 主控台之電腦上的 CreateTSMedia.log 記錄檔中。 您可以檢閱這個記錄檔來驗證工作順序變數的值。  

##  <a name="a-namebkmktscreatea-create-a-task-sequence"></a><a name="BKMK_TSCreate"></a> 建立工作順序  
 您會使用建立工作順序精靈建立工作順序。 該精靈會建立執行特定工作的內建工作順序，或是執行許多不同工作的自訂工作順序。  

 例如，您可以建立負責組建及擷取參照電腦 之作業系統映像的工作順序，可以在目的地電腦上安裝現有作業系統映像，或是建立負責執行自訂工作的自訂工作順序。 您可以使用自訂工作順序來執行特定的作業系統部署。  

 如需如何建立工作順序的詳細資訊，請參閱[建立工作順序](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_CreateTaskSequence)。  

##  <a name="a-namebkmktsedita-edit-a-task-sequence"></a><a name="BKMK_TSEdit"></a> 編輯工作順序  
 您可以使用 [工作順序編輯器] 編輯工作順序。 編輯器可以對工作順序做以下變更：  

-   您可以從工作順序新增或移除步驟。  

-   您可以變更工作順序的步驟順序。  

-   您可以新增或移除步驟群組。  

-   您可以指定當發生錯誤時工作順序是否要繼續。  

-   您可以將條件加入到工作順序的步驟和群組。  

> [!IMPORTANT]  
>  如果編輯後造成工作順序未關聯套件或程式參照，您必須校正參照、從工作順序刪除未參照的程式，或暫時停用失敗的工作順序步驟，直到校正或移除中斷的參照為止。  

 如需如何編輯工作順序的詳細資訊，請參閱[編輯工作順序](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_ModifyTaskSequence)。  

##  <a name="a-namebkmktsdeploya-deploy-a-task-sequence"></a><a name="BKMK_TSDeploy"></a> 部署工作順序  
 您可以將工作順序部署到位於任何 Configuration Manager 集合中的目的地電腦。 這包含用於將作業系統部署到未知電腦的 **[所有未知電腦]** 集合。 但不可將工作順序部署到使用者集合。  

> [!IMPORTANT]  
>  請勿部署將作業系統安裝到不適當集合的工作順序，例如 **[所有系統]** 集合。 請確定您要對其部署工作順序的集合僅包含要安裝作業系統的電腦。 您可以管理部署設定以避免不想要的作業系統部署。 如需詳細資訊，請參閱[管理高風險部署的設定](../../protect/understand/settings-to-manage-high-risk-deployments.md)。  

 每一部接收工作順序的目的地電腦，會根據部署中所指定的設定執行工作順序。 工作順序本身不包含相關聯的檔案或程式。 工作順序所參照的任何檔案，必須存在於目的地電腦上，或位於用戶端可存取的發佈點。 此外，工作順序會安裝由程式所參照的套件，即使目的地電腦上已安裝程式或套件。  

> [!NOTE]  
>  與套件及程式比較起來，假如工作順序安裝了應用程式，則只會在以下情況安裝應用程式：符合應用程式的需求規則，且尚未根據為應用程式指定的偵測方法安裝應用程式。  

 當 Configuration Manager 用戶端下載用戶端原則時，Configuration Manager 用戶端會執行工作順序部署。 若要起始此動作，而不是等到下一個輪詢週期才起始，請參閱[起始 Configuration Manager 用戶端的原則抓取](../../core/clients/manage/manage-clients.md#BKMK_PolicyRetrieval)。  

 將工作順序部署到啟用寫入篩選器的 Windows Embedded 裝置時，您可指定是否要在部署期間停用裝置上的寫入篩選器，然後在部署後重新啟動裝置。 如果寫入篩選器未停用，則軟體會部署為暫時重疊，而且無法在裝置重新啟動時使用。  

> [!NOTE]  
>  當您將工作順序部署到 Windows Embedded 裝置時，請確定該裝置是具有已設定之維護期間的集合成員。 這可讓您在停用並啟用寫入篩選器時，以及當重新啟動裝置時進行管理。  
>   
>  如果用戶端在維護期間外下載工作順序，便會下載兩次工作順序。 在此案例中， 用戶端會下載工作順序，停用寫入篩選器，重新啟動電腦，然後再次下載工作順序，因為下載到暫時重疊的工作順序會在裝置重新啟動時被清除。  

 如需如何部署工作順序的詳細資訊，請參閱[部署工作順序](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_DeployTS)。  

##  <a name="a-namebkmktsexportimporta-export-and-import-a-task-sequences"></a><a name="BKMK_TSExportImport"></a> 匯出和匯入工作順序  
 Configuration Manager 可讓您匯出和匯入工作順序。 當您匯出工作順序時，可將工作順序所參照的物件包含進去。 這些包括作業系統映像、開機映像、用戶端代理程式套件、驅動程式套件，以及具有相依性的應用程式。  

> [!NOTE]  
>  工作順序的匯出及匯入程序，與 Configuration Manager 中應用程式的匯出及匯入程序非常類似。  

 如需如何匯出和匯入工作順序的詳細資訊，請參閱[匯出和匯入工作順序](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_ExportImport)。  

##  <a name="a-namebkmktsruna-run-a-task-sequence"></a><a name="BKMK_TSRun"></a> 執行工作順序  
 根據預設，使用本機系統帳戶永遠都可執行工作順序。 工作順序命令列步驟會提供將工作順序當成不同帳戶來執行的能力。 在執行工作順序時，Configuration Manager 用戶端會在啟動工作順序步驟之前，先確認是否有任何參照的套件。 如果參照的套件未在發佈點上驗證，或無法使用時，工作順序會傳回關聯之工作順序步驟的錯誤。  

 如果發佈的工作順序設定為下載並執行，則所有相依套件和應用程式都會下載到 Configuration Manager 用戶端快取。 需要的套件和應用程式可從發佈點獲得，而且如果 Configuration Manager 用戶端快取大小太小，或找不到套件和應用程式，工作順序便會失敗，並且會產生狀態訊息。 您也可以在選取 **[執行工作順序以視需要將內容下載到本機]**時，指定用戶端只在需要時下載內容。或是使用 **[從發佈點執行程式]** 選項，指定用戶端直接從發佈點安裝檔案，不需先下載到快取。 僅當參考的套件已在 [套件] 內容的 [資料存取] 索引標籤上啟用 [將此套件中的內容複製到發佈點上的套件共用] 時，[從發佈點執行程式] 選項才可使用。  

 如果執行工作順序的用戶端找不到相依套件或應用程式，當將部署設定為 [有空] 時，用戶端會立即傳送錯誤。 不過，如果此部署設定為 [必要]，則當此內容尚未複寫到用戶端可以存取的發佈點時，Configuration Manager 用戶端就會等候，並在期限之前重試下載內容。  

 工作順序成功完成或失敗時，Configuration Manager 會將這項訊息記錄在 Configuration Manager 用戶端歷程記錄中。 這個動作在電腦上啟動後，您就無法取消或停止工作順序。  

> [!IMPORTANT]  
>  如果工作順序步驟要求用戶端電腦重新啟動，用戶端必須可以開機至格式化磁碟分割區。 否則，無論工作順序指定何種錯誤處理方式，工作順序都會失敗。  

 工作順序的相依物件 (例如軟體發佈套件) 更新至更新版本時，不論已部署多少更新，參照套件的任何工作順序都會自動更新並且會參照最新版本。  

> [!NOTE]  
>  在 Configuration Manager 用戶端執行工作順序之前，用戶端會檢查所有工作順序是否有可能的相依性，以及發佈點上之相依性的可用性。 如果用戶端找到工作順序相依的已刪除物件，用戶端會產生錯誤且不會執行工作順序。  

###  <a name="a-namebkmkrunprograma-run-a-program-before-the-task-sequence-is-run"></a><a name="BKMK_RunProgram"></a> 先執行程式再執行工作順序  
 您可以選取在執行工作順序之前執行的程式。 若要指定先執行的程式，開啟工作順序 [內容] 對話方塊，並選取 [進階] 索引標籤以設定下列選項：  

> [!IMPORTANT]  
>  若要在工作順序執行前執行程式，所有的工作順序與程式內容都必須在套件的套件共用上為可用。 您可以在套件內容的 **[資料存取]** 索引標籤上設定套件共用。  

-   **先執行其他程式**：指定您想要在執行工作順序前先執行的其他程式。  

    > [!IMPORTANT]  
    >  此設定僅適用於在完整作業系統中執行的工作順序。 如果使用 PXE 或開機媒體啟動工作順序，Configuration Manager 會忽略此設定。  

-   **套件**：指定包含該程式的套件。  

-   **程式**：指定要執行的程式。  

-   **永遠先執行此程式**：指定每次 Configuration Manager 在相同用戶端上執行工作順序時，您想要執行的程式。 根據預設，成功執行一個程式後，如果工作順序在相同用戶端上重新執行工作順序，就不會再次執行程式。  

 如果選取的程式無法在用戶端上執行，工作順序就不會執行。  

##  <a name="a-namebkmktsmaintenancewindowa-use-a-maintenance-window-to-specify-when-a-task-sequence-can-run"></a><a name="BKMK_TSMaintenanceWindow"></a> 使用維護期間指定工作順序可以執行的時間  
 您可以專為包含目的地電腦的集合定義一個維護期間，以藉此指定工作順序的執行時間。 維護期間的設定包括開始日期、開始與結束時間以及週期模式。 此外，在設定維護期間的排程時，您可以指定維護期間僅套用至工作順序。 如需詳細資訊，請參閱[如何使用維護期間](../../core/clients/manage/collections/use-maintenance-windows.md)。  

> [!IMPORTANT]  
>  設定維護期間執行工作順序時，一旦工作順序開始之後，即使將維護期間關閉，該順序仍會持續執行。 工作順序將順利完成或失敗。  

##  <a name="a-namebkmktsnetworkaccessaccounta-task-sequences-and-the-network-access-account"></a><a name="BKMK_TSNetworkAccessAccount"></a> 工作順序和網路存取帳戶  
 雖然工作順序只會在本機系統帳戶的環境中執行，您仍可能需要在下列情形中設定網路存取帳戶：  

-   您必須正確設定網路存取帳戶，否則當工作順序嘗試存取發佈點上的 Configuration Manager 套件以完成其工作時，工作將會失敗。 如需網路存取帳戶的詳細資訊，請參閱[網路存取帳戶](../../core/plan-design/hierarchy/manage-accounts-to-access-content.md#a-namebkmknaaa-network-access-account)。  

    > [!NOTE]  
    >  網路存取帳戶從未作為執行程式、安裝應用程式、安裝更新或是執行工作順序的安全性內容使用，但網路存取帳戶可用來存取網路上的相關資源。  

-   使用開機映像啟動作業系統部署時，Configuration Manager 會使用非完整作業系統的 Windows PE 環境。 Windows PE 環境使用自動產生的隨機名稱，且該名稱不能是任何網域的成員。 如果您沒有正確設定網路存取帳戶，電腦可能不會有存取必要 Configuration Manager 套件所需的必要權限來完成工作順序。  

##  <a name="a-namebkmktscreatemediaa-create-media-for-task-sequences"></a><a name="BKMK_TSCreateMedia"></a> 建立工作順序的媒體  
 您可寫入工作順序與其相關檔案以及數種媒體類型的相依性。 這包括寫入至可移除媒體，例如擷取、獨立以及可開機媒體的 DVD 或 CD 組或 USB 快閃磁碟機，或是寫入至預先設置媒體的 Windows 映像格式 (WIM) 檔案。  

 您可以建立下列媒體類型：  

-   **擷取媒體**。 擷取媒體擷取在 Configuration Manager 基礎結構外設定與建立的作業系統映像。 擷取媒體可以包含在工作順序執行前執行的自訂程式。 自訂程式可以與桌面互動、提示使用者輸入數值，或是建立由工作順序使用的變數。  

     如需詳細資訊，請參閱[建立擷取媒體](../deploy-use/create-capture-media.md)。  

-   **獨立媒體**。 獨立媒體包含工作順序與可讓工作順序執行的所有必要相關物件。 獨立媒體工作順序可在 Configuration Manager 受到限制或沒有網路連線時執行。 獨立媒體可依照下列方式執行：  

    -   如果目的地電腦未開機，則會從獨立媒體使用與工作順序相關的 Windows PE 映像，使工作順序開始進行。  

    -   如果使用者登入網路並啟動安裝，就可以手動啟動獨立媒體。  

    > [!IMPORTANT]  
    >  獨立媒體工作順序的步驟必須可以在不從網路擷取任何資料的條件下執行，否則嘗試擷取資料的工作順序步驟就會失敗。 例如，要求發佈點取得套件的工作順序步驟失敗；但如果獨立媒體包含必要套件，工作順序步驟就可順利執行。  

     如需詳細資訊，請參閱[建立獨立媒體](../deploy-use/create-stand-alone-media.md)。  

-   **可開機媒體**。 可開機媒體包含啟動目的地電腦的必要檔案，使電腦可連線到 Configuration Manager 基礎結構，以根據工作順序在集合中的成員身分來決定要執行的工作順序。 工作順序與相依物件不包含在媒體中；而是透過網路從 Configuration Manager 用戶端取得。 這個方法對於新電腦或是裸機部署來說都很有用，或是當目的地電腦上沒有 Configuration Manager 用戶端或作業系統時也很有用。  

     如需詳細資訊，請參閱[建立可開機媒體](../deploy-use/create-bootable-media.md)。  

-   **預先設置的媒體**。 預先設置媒體部署作業系統映像到未佈建的目的地電腦。 預先設置的媒體儲存為 Windows 映像格式 (WIM) 檔案，可由廠商或在企業設置中心安裝於未連線 Configuration Manager 環境的裸機電腦上。  

     如需詳細資訊，請參閱[建立預先設置的媒體](../deploy-use/create-prestaged-media.md)。  

 建立媒體時，指定媒體的密碼以控制存取包含在媒體上的檔案。 如果您指定密碼，執行工作順序時，使用者必須現場將密碼輸入目標電腦。  

 使用媒體執行工作順序時，將無法辨識媒體上包含的指定電腦晶片架構，即使指定的架構不符合實際安裝在目標電腦上的架構，工作順序仍會嘗試執行。 如果媒體上的晶片架構與目標電腦上所安裝的晶片架構不符，安裝就會失敗。  

 如需如何使用媒體部署作業系統的詳細資訊，請參閱[建立工作順序媒體](../deploy-use/create-task-sequence-media.md)。  



<!--HONumber=Nov16_HO1-->


