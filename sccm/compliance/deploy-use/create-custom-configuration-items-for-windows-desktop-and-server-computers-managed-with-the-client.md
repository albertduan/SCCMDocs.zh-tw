---
title: "為用戶端管理的 Windows 電腦建立設定項目 - Configuration Manager | Microsoft Docs"
description: "使用自訂 Windows 桌上型電腦和伺服器設定項目，管理 Windows 電腦和伺服器的設定。"
ms.custom: na
ms.date: 11/18/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-other
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 1eb2fcaf-acac-4388-9b31-6cccafacaabe
caps.latest.revision: "9"
caps.handback.revision: "0"
author: andredm7
ms.author: andredm
manager: angrobe
ms.openlocfilehash: 9fe28782744a419acad9c1acec49ff8db6c0eaa6
ms.sourcegitcommit: b438515490e04fb09c82a8af642d38e9a0605178
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/15/2017
---
# <a name="how-to-create-custom-configuration-items-for-windows-desktop-and-server-computers-managed-with-the-system-center-configuration-manager-client"></a>如何為 System Center Configuration Manager 用戶端所管理的 Windows 桌上型電腦和伺服器電腦建立自訂組態項目

*適用於︰System Center Configuration Manager (最新分支)*


使用 System Center Configuration Manager **自訂 Windows 桌上型電腦和伺服器**設定項目，管理 Configuration Manager 用戶端所管理之 Windows 電腦和伺服器的設定。  

## <a name="start-the-create-configuration-item-wizard"></a>啟動建立設定項目精靈

1.  在 Configuration Manager 主控台中，按一下 [資產與相容性] > [相容性設定] > [設定項目]。  

3.  在 [常用] 索引標籤上，按一下 [建立] 群組中的 [建立設定項目]。  

4.  在 [建立設定項目精靈]  的 [一般] 頁面上，指定設定項目的名稱和選擇性描述。  

5.  在 [指定您要建立的組態項目類型] 下，選取 [Windows 桌上型電腦和伺服器 (自訂)] 。  

    > [!TIP]  
    >  如果您要提供偵測方法設定以檢查是否有應用程式，請選取 [此組態檔案包含應用程式設定] 。  

6.  如果您要建立並指派類別，以協助您在 Configuration Manager 主控台中搜尋和篩選設定項目，請按一下 [類別]。  

## <a name="provide-detection-method-information"></a>提供偵測方法資訊  
 您可以使用這個程序，來提供組態項目的偵測方法資訊。  

> [!NOTE]  
>  只有當您選取適用 **這個組態項目包含應用程式設定** 上 **一般** 精靈頁面。  

 Configuration Manager 中的偵測方法包含用來偵測電腦上是否安裝應用程式的規則。 這項偵測是之前的組態項目評估相容。 若要偵測是否已安裝應用程式，您可以偵測應用程式的 Windows Installer 檔案是否存在，使用自訂指令碼，或選取 **一律假設應用程式安裝** 評估不論是否已安裝應用程式的相容性的組態項目。  

 使用這些程序以在 System Center Configuration Manager 中設定偵測方法。  

### <a name="to-detect-an-application-installation-by-using-the-windows-installer-file"></a>若要使用 Windows Installer 檔案來偵測應用程式安裝  

1.  在 **偵測方法** 頁面 **建立的組態項目 精靈**, 、 選取 **使用 Windows 安裝程式偵測** 核取方塊。  

2.  按一下 **開啟**, ，瀏覽至您想要偵測，然後按一下 Windows Installer (.msi) 檔案 **開啟**。  

3.  **版本** 方塊會自動填入您所選取的 Windows Installer 檔案的版本號碼。 您可以在此方塊中輸入新的版本號碼如果顯示的值不正確。  

4.  如果您要偵測電腦上的每個使用者設定檔，請選取 [已針對一或多個使用者安裝此應用程式]  核取方塊。  

### <a name="to-detect-a-specific-application-and-deployment-type"></a>偵測特定應用程式和部署類型  

1.  在 [建立設定項目精靈]  的 [偵測方法] 頁面上，選取 [偵測特定應用程式和部署類型]  核取方塊，然後按一下 [選取] 。  

2.  在 [指定應用程式]  對話方塊中，選取您要偵測的應用程式和相關聯的部署類型。  

### <a name="to-detect-an-application-installation-by-using-a-custom-script"></a>使用自訂指令碼偵測應用程式安裝  

1.  在 **偵測方法** 頁面 **建立的組態項目 精靈**, 、 選取 **使用自訂的指令碼來偵測此應用程式** 核取方塊。  

2.  在清單中選取您想要開啟的指令碼語言。 選擇下列指令碼：  

    -   **VBScript**  

    -   **JScript**  

    -   **PowerShell**  

3.  按一下 [開啟舊檔] ，瀏覽至您要使用的指令碼，然後按一下 [開啟] 。  

##  <a name="configure-settings"></a>進行設定  
 您可以使用這個程序，來進行組態項目中的設定。  

 設定代表商務或技術可用來評估用戶端裝置上的符合性的條件。 您可以進行新的設定，或瀏覽至參照電腦上現有的設定。  

1.  在 **設定** 頁面 **建立的組態項目 精靈**, ，按一下 **新增**。  

2.  在 **一般**  索引標籤 **建立設定**  對話方塊中，提供下列資訊:  

    -   **名稱：** 輸入設定的唯一名稱。 您最多可以使用 256 個字元。  

    -   **描述:** 輸入設定的描述。 您最多可以使用 256 個字元。  

    -   **設定類型︰** 在清單中選擇並設定要用於此項設定的其中一個設定類型：  

        -   **Active Directory 查詢**  

             **LDAP 首碼** - 為 Active Directory 網域服務查詢指定有效的首碼，以評估用戶端電腦上的相容性。 您可以使用 **LDAP: / /** 如或 **GC: / /** 來執行通用類別目錄搜尋...  

             **辨別名稱 (DN)** -指定評估是否符合用戶端電腦上的 Active Directory 網域服務物件的辨別的名稱。  

             例如，如果您要評估與 corp.contoso.com 網域中名為 John Smith 之使用者相關的值，請輸入下列：  

            -   **搜尋篩選器** - 指定選擇性 LDAP 篩選器以縮小 Active Directory 網域服務查詢的結果搜尋範圍，以評估用戶端電腦上的相容性。  

                 若要從查詢傳回所有結果，請輸入 **(objectclass=\*)**。  

            -   **搜尋範圍** - 指定 Active Directory 網域服務中的搜尋範圍。可用選項：  

                -   **基底** -查詢所指定的物件。  

                -   **單層** - 在此 Configuration Manager 版本中不使用此選項。  

                -   **樹狀子目錄** -查詢指定的物件和其完整的樹狀子目錄的目錄中。  

            -   **屬性** -指定用來評估用戶端電腦上的符合性 Active Directory 網域服務物件的屬性。  

                 例如，如果您想要查詢 Active Directory 屬性 **Bold**, 、 儲存的使用者不正確地輸入密碼的次數、 輸入 **Bold** 在此欄位中。  

            -   **查詢** -顯示查詢中的項目從建構 **LDAP 前置詞**, ， **辨別的名稱 (DN)**, ， **搜尋篩選器** (如果有指定)，和 **屬性**, ，用來評估用戶端電腦上的符合性。  

             如需建構 LDAP 查詢的詳細資訊，請參閱 Windows Server 文件。  

        -   **組件**  

             針對此設定類型進行下列設定：  

            -   **組件名稱：** 指定您想要搜尋的組件物件的名稱。 名稱不能相同類型的其他組件物件相同而且必須在全域組件快取中註冊。 組件名稱的長度上限為 256 個字元。  

             該組件是可在應用程式間共用的一組代碼。 組件的副檔名可以是 .dll 或 .exe。 全域組件快取是名為資料夾 *%systemroot%\Assembly* 所有共用的組件所在的電腦會儲存在用戶端上。  

        -   **檔案系統**  

            -   **類型** - 在此清單中，選取您要搜尋 [檔案]  或 [資料夾] 。  

            -   **路徑** -指定用戶端電腦上指定的檔案或資料夾的路徑。 您可以指定系統環境變數和路徑中的 *%USERPROFILE%* 環境變數。  

                > [!NOTE]  
                >  如果您在 [路徑]  或 [檔案或資料夾名稱]  方塊中使用 **%USERPROFILE%** 環境變數，則會搜尋用戶端電腦上的所有使用者設定檔，而導致找到多個檔案或資料夾執行個體。  
                >   
                >  如果相容性設定無法存取指定的路徑，則會產生探索錯誤。 此外，如果您要搜尋的檔案目前正在使用中，探索會產生錯誤。  

            -   **檔案或資料夾名稱** -指定要搜尋的檔案或資料夾物件的名稱。 您可以指定系統環境變數和檔案或資料夾名稱中的 *%USERPROFILE%* 環境變數。 您也可以在檔案名稱中 使用萬用字元 * 和 ?。  

                > [!NOTE]  
                >  如果您指定檔案或資料夾名稱並使用萬用字元，這種組合可能會產生大量結果，而導致用戶端電腦上的高資源使用量，並且在向 Configuration Manager 報告結果時也會產生相當高的網路流量。  

            -   **包含子資料夾** – 如果您同時需要搜尋指定路徑下的任何子資料夾，可啟用此選項。  

            -   **此檔案或資料夾是 64 位元應用程式相關聯** – 如果啟用，只有 64 位元檔案位置 (例如 *%programfiles%*) 會檢查在 64 位元電腦上。 如果未啟用這個選項，則會同時檢查 32 位元 (例如 *%ProgramFiles(x86)%*) 和 64 位元位置。  

                > [!NOTE]  
                >  如果同一部 64 位元電腦上的 64 位元和 32 位元系統檔案位置中同時存在相同的檔案或資料夾，則全域條件會探索多個檔案。  

             [檔案系統]  設定類型不支援在 [路徑]  方塊中將 UNC 路徑指定為網路共用。  

        -   **IIS Metabase**  

            -   **Metabase 路徑** - 指定 Internet Information Services (IIS) Metabase 的有效路徑。  

            -   **內容識別碼** - 指定 IIS Metabase 設定的數值內容。  

        -   **登錄機碼**  

            -   **登錄區** - 在清單中，選取您要在其中搜尋的登錄區。  

            -   **機碼** - 指定您要搜尋的登錄機碼名稱。 使用格式 *key\subkey*。  

            -   **這個登錄機碼是 64 位元應用程式相關聯** -指定是否應該在執行 Windows 64 位元版本的用戶端上的 32 位元登錄機碼除了搜尋 64 位元登錄機碼。  

                > [!NOTE]  
                >  如果同一部 64 位元電腦上的 64 位元和 32 位元登錄位置中同時存在相同的登錄機碼，則全域條件會同時探索這兩個登錄機碼。  

        -   **登錄值**  

            -   **登錄區** - 在清單中，選取您要在其中搜尋的登錄區。  

            -   **機碼** - 指定您要搜尋的登錄機碼名稱。 使用格式 *key\subkey*。  

            -   **值** – 指定必須包含在所指定登錄機碼中的值。  

            -   **這個登錄機碼是 64 位元應用程式相關聯** -指定是否應該在執行 Windows 64 位元版本的用戶端上的 32 位元登錄機碼除了搜尋 64 位元登錄機碼。  

                > [!NOTE]  
                >  如果同一部 64 位元電腦上的 64 位元和 32 位元登錄位置中同時存在相同的登錄機碼，則全域條件會同時探索這兩個登錄機碼。  

             您也可以按一下 [瀏覽]  瀏覽至電腦或遠端電腦上的登錄位置。 瀏覽遠端電腦，您必須在遠端電腦上擁有系統管理員權限和遠端電腦必須執行遠端登錄服務。  

        -   **指令碼**  

            -   **探索指令碼** - 按一下 [新增]  以輸入或瀏覽至您要使用的指令碼。 您可以使用 Windows PowerShell、 VBScript、 或 Microsoft JScript 指令碼。  

            -   **使用登入的使用者認證來執行指令碼** - 如果您啟用這個選項，指令碼會在使用登入使用者認證的用戶端電腦上執行。  

                > [!NOTE]  
                >  指令碼傳回的值可用來評估全域條件的相容性。 例如，使用 VBScript 時，您可以使用命令 **WScript.Echo Result** 將 *Result* 變數值傳回至全域條件。  

        -   **SQL 查詢**  

            -   **SQL Server 執行個體** – 選擇要在預設執行個體、所有執行個體還是指定的資料庫執行個體名稱上執行 SQL 查詢。  

                > [!NOTE]  
                >  執行個體名稱必須參考 SQL Server 的本機執行個體。 若要參考叢集 SQL Server 執行個體，您應使用指令碼設定。  

            -   **資料庫** -指定要執行 SQL 查詢的 Microsoft SQL Server 資料庫的名稱。  

            -   **資料行** -指定用來評估全域條件的相容性的 TRANSACT-SQL 陳述式所傳回的資料行名稱。  

            -   **TRANSACT-SQL 陳述式** – 指定您想要使用全域條件的完整 SQL 查詢。 您也可以按一下 [開啟]  來開啟現有的 SQL 查詢。  

                > [!IMPORTANT]  
                >  SQL 查詢設定並不支援任何修改資料庫的 SQL 命令。 您只能使用 SQL 命令從資料庫讀取資訊。  

        -   **WQL 查詢**  

            -   **命名空間** -指定用來建立評估是否符合用戶端電腦上的 WQL 查詢的 Windows Management Instrumentation (WMI) 命名空間。 預設值為 Root\cimv2。  

            -   **類別** -指定用來建立評估是否符合用戶端電腦上的 WQL 查詢的 WMI 類別。  

            -   **屬性** -指定用來建立評估是否符合用戶端電腦上的 WQL 查詢的 WMI 屬性。  

            -   **WQL 查詢的 WHERE 子句** -您可以使用 **WQL 查詢的 WHERE 子句** 項目來指定 WHERE 子句套用至指定的命名空間、 類別和用戶端電腦上的屬性。  

        -   **XPath 查詢**  

            -   **路徑** - 指定 .xml 檔案在用戶端電腦上的路徑，以用來評估相容性。 Configuration Manager 支援在路徑名稱中使用所有 Windows 系統環境變數和 *%USERPROFILE%* 使用者變數。  

            -   **XML 檔案名稱** -指定包含用來評估用戶端電腦上的符合性的 XML 查詢的檔案名稱。  

            -   **包含子資料夾** - 如果您需要同時搜尋指定路徑下的任何子資料夾，可啟用此選項。  

            -   **此檔案與 64 位元應用程式相關聯** - 選擇除了在執行 Windows 64 位元版本的 Configuration Manager 用戶端上的 32 位元系統檔案位置 (*%windir%*\Syswow64) 以外，是否也應搜尋 64 位元系統檔案位置 (*%windir%*\System32)。  

            -   **XPath 查詢** -指定的有效完整 XML 路徑語言 (XPath) 查詢用來評估用戶端電腦上的符合性。  

            -   **命名空間** - 開啟 [XML 命名空間]  對話方塊，以識別 XPath 查詢期間所要使用的命名空間和首碼。  

             如果您嘗試探索加密的 .xml 檔案，相容性設定會找到該檔案，但 XPath 查詢不會產生結果，也不會產生錯誤。  

             如果 XPath 查詢無效，此設定會在用戶端電腦上評估為不相容。  

    -   **資料類型** ：在此清單中，選擇條件傳回資料所使用的格式，再使用條件來評估設定。 **資料型別** 清單不會顯示所有設定類型。  

        > [!NOTE]  
        >  **浮點數** 資料類型支援只有 3 個數字的小數點後。  

3.  設定此設定下的其他詳細 **類型設定** 清單。 您可以設定的項目會因您所選取的設定類型而異。  

    > [!NOTE]  
    >  當您建立的型別設定 **檔案系統**, ， **登錄機碼**, ，和 **登錄值**, ，您可以按一下 **瀏覽** 在參照電腦上設定的設定值。 若要瀏覽至登錄機碼或遠端電腦上的值，遠端電腦必須啟用遠端登錄服務。  

4.  按一下 [確定]  儲存設定，然後關閉 [建立設定]  對話方塊。  

##  <a name="configure-compliance-rules"></a>設定相容性規則  
 您可以使用下列程序，為組態項目設定相容性規則。  

 符合性規則指定定義設定項目的相容性的條件。 設定可以評估合乎規範之前，必須至少一個符合性規則。 WMI、 登錄和指令碼設定可讓您修復不符合找到的值。 您可以建立新的規則或瀏覽至任何組態項目中選取規則中現有的設定。  

### <a name="to-create-a-compliance-rule"></a>若要建立符合性規則  

1.  在 **相關之法規規則** 頁面 **建立的組態項目 精靈**, ，按一下 **新增**。  

2.  在 **Create Rule**  對話方塊中，提供下列資訊：  

    -   **名稱：** 輸入符合性規則的名稱。  

    -   **描述:** 輸入符合性規則的描述。  

    -   **選取的設定︰** 按一下 **瀏覽** 開啟 **選取設定** 對話方塊。 選取您想要定義的規則或按一下 設定 **新設定**。 當您完成時，請按一下 **選取**。  

        > [!NOTE]  
        >  您也可以按一下 **屬性** 若要檢視目前所選設定的相關資訊。  

    -   **規則類型:** 選取您想要使用的符合性規則類型：  

        -   **值** 建立規則來比較符合您指定的值的組態項目所傳回的值。  

        -   **Existential** 建立評估根據存在找到它的次數或用戶端裝置上設定的規則。  

    -   規則類型的 **值**, ，指定下列資訊：  

        -   **設定必須遵守下列規則** – 選取操作員和評估是否符合選取之設定的值。 您可以使用下列運算子：  

            |運算子|詳細資訊|  
            |--------------|----------------------|  
            |等於|沒有其他資訊|  
            |不等於|沒有其他資訊|  
            |大於|沒有其他資訊|  
            |小於|沒有其他資訊|  
            |介於|沒有其他資訊|  
            |大於或等於|沒有其他資訊|  
            |小於或等於|沒有其他資訊|  
            |其中一個|在文字方塊中的每一行指定一個項目。|  
            |沒有任何|在文字方塊中的每一行指定一個項目。|  

        -   **支援時補救不相容的規則** - 如果您要讓 Configuration Manager 自動補救不相容的規則，請選取這個選項。 Configuration Manager 可以自動補救下列規則類型：  

            -   **登錄值** – 登錄值修復不合格時建立如果不存在。  

            -   **指令碼** (藉由自動執行修復指令碼)。  

            -   **WQL Query**  

            > [!IMPORTANT]  
            >  當設定為規則運算子可以只修復不合格的規則 **等於**。  

        -   **如果找不到此設定執行個體報告檢驗** – 如果用戶端電腦上找不到這項設定會設定項目報告不相容。  

        -   **報告的不相容嚴重性**：指定這個相容性原則失敗時要回報的嚴重性等級 (在 Configuration Manager 報告中)。 可用的嚴重性等級如下：  

            -   **無**：不符合這項相容性規則的電腦不會回報失敗嚴重性。  

            -   **資訊**：不符合這項相容性規則的電腦會回報 [資訊] 失敗嚴重性。  

            -   **警告**：不符合這項相容性規則的電腦會回報 [警告] 失敗嚴重性。  

            -   **重大**：不符合這項相容性規則的電腦會回報 [重大] 失敗嚴重性。  

            -   **重大事件**：不符合這項相容性規則的電腦會回報 [重大] 失敗嚴重性。 此嚴重性層級也會在應用程式事件記錄檔中記錄為 Windows 事件。  

        -   規則類型的 **Existential**, ，指定下列資訊：  

            > [!NOTE]  
            >  所顯示的選項可能會根據您要設定的規則設定類型而有所不同。  

            -   **設定必須存在於用戶端裝置**  

            -   **此設定必須存在於用戶端裝置**  

            -   **此設定就會發生下列次數:**  

        -   **報告的不相容嚴重性**：指定這個相容性原則失敗時要回報的嚴重性等級 (在 Configuration Manager 報告中)。 可用的嚴重性等級如下：  

            -   **無**：不符合這項相容性規則的電腦不會回報失敗嚴重性。  

            -   **資訊**：不符合這項相容性規則的電腦會回報 [資訊] 失敗嚴重性。  

            -   **警告**：不符合這項相容性規則的電腦會回報 [警告] 失敗嚴重性。  

            -   **重大**：不符合這項相容性規則的電腦會回報 [重大] 失敗嚴重性。  

            -   **重大事件**：不符合這項相容性規則的電腦會回報 [重大] 失敗嚴重性。 此嚴重性層級也會在應用程式事件記錄檔中記錄為 Windows 事件。  

3.  按一下 [確定]  關閉 [建立規則]  對話方塊。  

##  <a name="specify-supported-platforms"></a>指定支援的平台  
 支援的平台是評估組態項目相容性所在的作業系統。  

在 [建立設定項目精靈]  的 [支援的平台] 頁面上，從清單中選取您要評估設定項目相容性所在的 Windows 版本，或按一下 [全選] 。  

## <a name="complete-the-wizard"></a>完成精靈  
 在精靈的 [摘要]  頁面上，檢閱將採取的動作，然後完成精靈。 新的設定項目會顯示在 **設定項目** 中的節點 **資產與相容性** 工作區。  
